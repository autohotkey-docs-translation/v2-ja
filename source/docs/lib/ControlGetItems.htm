<!DOCTYPE HTML>
<html lang="en">
<head>
<title>ControlGetItems - Syntax &amp; Usage | AutoHotkey v2</title>
<meta name="description" content="The ControlGetItems function returns an array of items/rows from a ListBox, ComboBox, or DropDownList." />
<meta name="ahk:equiv-v1" content="lib/ControlGet.htm#List" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>ControlGetItems</h1>

<p>Returns an array of items/rows from a ListBox, ComboBox, or DropDownList.</p>

<pre class="Syntax">Items := <span class="func">ControlGetItems</span>(Control <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span>)</pre>

<h2 id="Parameters">Parameters</h2>
<dl>
    <dt>Control</dt>
    <dd>
        <p>Type: <a href="../Concepts.htm#strings">String</a>, <a href="../Concepts.htm#numbers">Integer</a> or <a href="../Concepts.htm#objects">Object</a></p>
        <p>The control's ClassNN, text or HWND, or an object with a <code>Hwnd</code> property. For details, see <a href="Control.htm#Parameter">The Control Parameter</a>.</p>
    </dd>
    <dt>WinTitle, WinText, ExcludeTitle, ExcludeText</dt>
    <dd>
        <p>Type: <a href="../Concepts.htm#strings">String</a>, <a href="../Concepts.htm#numbers">Integer</a> or <a href="../Concepts.htm#objects">Object</a></p>
        <p>If each of these is blank or omitted, the <a href="../misc/WinTitle.htm#LastFoundWindow">Last Found Window</a> will be used. Otherwise, specify for <em>WinTitle</em> a <a href="../misc/WinTitle.htm">window title or other criteria</a> to identify the target window and/or for <em>WinText</em> a substring from a single text element of the target window (as revealed by the included Window Spy utility).</p>
        <p><em>ExcludeTitle</em> and <em>ExcludeText</em> can be used to exclude one or more windows by their title or text. Their specification is similar to <em>WinTitle</em> and <em>WinText</em>, except that <em>ExcludeTitle</em> does not recognize any criteria other than the window title.</p>
        <p>Window titles and text are case-sensitive. By default, hidden windows are not detected and hidden text elements are detected, unless changed with <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> and <a href="DetectHiddenText.htm">DetectHiddenText</a>. By default, a window title can contain <em>WinTitle</em> or <em>ExcludeTitle</em> anywhere inside it to be a match, unless changed with <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>.</p>
    </dd>
</dl>

<h2 id="Return_Value">Return Value</h2>
<p>Type: <a href="Array.htm">Array</a></p>
<p>This function returns an array containing the text of each item or row.</p>

<h2 id="Error_Handling">Error Handling</h2>
<p>A <a href="Error.htm#TargetError">TargetError</a> is thrown if the window or control could not be found, or if the control's class name does not contain "Combo" or "List".</p>
<p>An <a href="Error.htm">Error</a> is thrown on failure, such as if a message returned a failure code or could not be sent.</p>

<h2 id="Remarks">Remarks</h2>
<p>Some applications store their item data privately, which prevents their text from being retrieved. In these cases, an exception will usually not be thrown, but all the retrieved fields will be empty.</p>

<h2 id="Related">Related</h2>
<p><a href="ListViewGetContent.htm">ListViewGetContent</a>, <a href="WinGetList.htm">WinGetList</a>, <a href="Control.htm">Control functions</a></p>

<h2 id="Examples">Examples</h2>
<div class="ex" id="ExFor">
<p><a class="ex_number" href="#ExFor"></a> Accesses the items one by one.</p>
<pre>for item in ControlGetItems("ComboBox1", WinTitle)
    MsgBox "Item number " A_Index " is " item</pre>
</div>

<div class="ex" id="ExIndex">
<p><a class="ex_number" href="#ExIndex"></a> Accesses a specific item by index.</p>
<pre>items := ControlGetItems("ListBox1", WinTitle)
MsgBox "The first item is " items[1]
MsgBox "The last item is " items[-1]</pre>
</div>

</body>
</html>
