<!DOCTYPE HTML>
<html lang="en">
<head>
<title>GetKeyVK - Syntax &amp; Usage | AutoHotkey v2</title>
<meta name="description" content="The GetKeyVK function retrieves the virtual key code of a key." />
<meta name="ahk:equiv-v1" content="lib/GetKey.htm" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>GetKeyVK</h1>

<p>Retrieves the virtual key code of a key.</p>

<pre class="Syntax">VK := <span class="func">GetKeyVK</span>(KeyName)</pre>
<h2 id="Parameters">Parameters</h2>
<dl>

  <dt>KeyName</dt>
  <dd>
    <p>Type: <a href="../Concepts.htm#strings">String</a></p>
    <p>Any single character or one of the key names from the <a href="../KeyList.htm">key list</a>. Examples: B, 5, LWin, RControl, Alt, Enter, Escape.</p>
    <p>Alternatively, this can be an explicit virtual key code such as vkFF, an explicit scan code such as sc01D, or a combination of VK and SC (in that order) such as vk1Bsc001. Note that these codes must be in hexadecimal.</p>
  </dd>

</dl>

<h2 id="Return_Value">Return Value</h2>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
<p>This function returns the virtual key code of the specified key, or 0 if the key is invalid or has no virtual key code.</p>

<h2 id="Remarks">Remarks</h2>
<p>Before using the virtual key code with a built-in function like <a href="Hotkey.htm">Hotkey</a> or <a href="GetKeyState.htm">GetKeyState</a>, it must first be converted to hexadecimal format, such as by using <code>Format("vk{:X}", vk_code)</code>. By contrast, external functions called via <a href="DllCall.htm">DllCall</a> typically use the numeric value directly.</p>
<p>If <em>KeyName</em> corresponds to a scan code or single character, the function attempts to map the value to a virtual key code by calling certain system functions which refer to the script's current keyboard layout. This may differ from the keyboard layout of the active window.</p>
<p>If <em>KeyName</em> is an ASCII letter in the range A-Z and has no mapping within the keyboard layout, the corresponding virtual key in the range vk41-vk5A is used as a fallback.</p>
<p>Some keyboard layouts do not define a 1:1 mapping of virtual key codes to scan codes. When multiple interpretations are possible, the underlying system functions most likely choose one based on the order defined in the keyboard layout, which is not always the most common or logical choice.</p>

<h2 id="Related">Related</h2>
<p><a href="GetKeySC.htm">GetKeySC</a>, <a href="GetKeyName.htm">GetKeyName</a>, <a href="GetKeyState.htm">GetKeyState</a>, <a href="../KeyList.htm">Key List</a>, <a href="Format.htm">Format</a></p>
<h2 id="Examples">Examples</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> Retrieves and reports the hexadecimal virtual key code of <kbd>Esc</kbd>.</p>
<pre>vk_code := GetKeyVK("Esc")
MsgBox Format("vk{:X}", vk_code) <em>; Reports vk1B</em></pre>
</div>

</body>
</html>
