<!DOCTYPE HTML>
<html lang="ja">
<head>
<title>KeyHistory - 構文と使用法｜AutoHotkey v2</title>
<meta name="description" content="KeyHistory機能は、スクリプト情報と直近のキー操作やマウスクリックの履歴を表示する機能です。" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>KeyHistory</h1>

<p>スクリプト情報、直近のキー操作やマウスクリックの履歴を表示します。</p>

<pre class="Syntax"><span class="func">KeyHistory</span> <span class="optional">MaxEvents</span></pre>
<h2 id="Parameters">パラメータ</h2>
<dl>

  <dt>MaxEvents</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#numbers">整数</a></p>
    <p>このパラメータを省略すると、スクリプトの<a href="../Program.htm#main-window">メインウィンドウ</a>が表示され、「表示-&gt;キーヒストリー」メニュー項目を選択した場合と同じになります。</p>
    <p>それ以外の場合、このパラメータは、ウィンドウに表示するために記録できるキーボードおよびマウスイベントの最大数を設定します（デフォルト40、上限500）。キーヒストリーもリセットされますが、メインウィンドウの表示やリフレッシュはされません。キーヒストリーを完全に無効にする場合は、0を指定します。</p>
  </dd>

</dl>

<h2 id="Remarks">備考</h2>
<p>キーヒストリーを無効にする場合は、次のようにします：</p>
<pre>KeyHistory 0</pre>
<p>この機能は、<a href="../Scripts.htm#debug">スクリプトやホットキーのデバッグ</a>に役立つことを目的としています。また、<a href="../KeyList.htm#SpecialKeys">キー一覧</a>ページの下部に記載されている手順で、非標準キーボードキーのスキャンコードを検出することもできます（スキャンコードを知ることで、そのキーをホットキーにすることができます）。</p>
<p>ホイールイベント（WheelDown、WheelUp、WheelLeft、WheelRight）の仮想キー（VK）は、AutoHotkeyの外では意味を持たないプレースホルダー値です。また、ホイールイベントのスキャンコードは、実際にはホイールを回したノッチの数（通常は1）です。</p>
<p>スクリプトに<a href="InstallKeybdHook.htm">キーボードフック</a>がインストールされていない場合、KeyHistoryウィンドウには、スクリプト自体によって生成された（つまり、ユーザーのものではない）キーボードイベントのみが表示されます。スクリプトに<a href="InstallMouseHook.htm">マウスフック</a>がインストールされていない場合、マウスボタンイベントは表示されません。スクリプトがどちらのフックを使用しているかは、スクリプトのメインウィンドウの「表示-&gt;キー履歴」（トレイアイコンの「開く」からアクセスできます）で確認できます。以下の行のどちらか、または両方をスクリプトに追加することで、フックを強制的にインストールさせることができます：</p>
<pre><a href="InstallKeybdHook.htm">InstallKeybdHook</a>
<a href="InstallMouseHook.htm">InstallMouseHook</a></pre>
<p>キーストロークやマウスクリックはダウンイベントとアップイベントで構成されているため、KeyHistoryは<em>MaxEvents</em>で指定された数の半分の「完全なイベント」しか表示しません。例えば、スクリプトが<code>KeyHistory 50</code>を呼び出すと、最大25個のキーストロークとマウスクリックが表示されます。</p>

<h2 id="Related">関連</h2>
<p><a href="InstallKeybdHook.htm">InstallKeybdHook</a>, <a href="InstallMouseHook.htm">InstallMouseHook</a>, <a href="ListHotkeys.htm">ListHotkeys</a>, <a href="ListLines.htm">ListLines</a>, <a href="ListVars.htm">ListVars</a>, <a href="GetKeyState.htm">GetKeyState</a>, <a href="KeyWait.htm">KeyWait</a>, <a href="../Variables.htm#PriorKey">A_PriorKey</a></p>

<h2 id="Examples">例</h2>

<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> 履歴情報をウィンドウに表示します。</p>
<pre>KeyHistory</pre>
</div>

<div class="ex" id="ExMaxEvents">
<p><a class="ex_number" href="#ExMaxEvents"></a> <code>KeyHistory</code>に、40個のキーボードとマウスイベントの代わりに、最後の100個のイベントを表示するようにします。</p>
<pre>KeyHistory 100</pre>
</div>

<div class="ex" id="ExDisable">
<p><a class="ex_number" href="#ExDisable"></a> キーヒストリーを完全に無効にします。</p>
<pre>KeyHistory 0</pre>
</div>

</body>
</html>
