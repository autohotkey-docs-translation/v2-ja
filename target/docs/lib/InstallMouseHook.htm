<!DOCTYPE HTML>
<html lang="jac">
<head>
<title>InstallMouseHook - 構文と使用法｜AutoHotkey v2</title>
<meta name="description" content="InstallMouseHook関数は、マウスフックをインストールまたはアンインストールします。" />
<meta name="ahk:equiv-v1" content="lib/_InstallMouseHook.htm" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>InstallMouseHook</h1>

<p>マウスフックをインストールまたはアンインストールします。</p>
<pre class="Syntax"><span class="func">InstallMouseHook</span> <span class="optional">Install, Force</span></pre>

<h2 id="Parameters">パラメータ</h2>
<dl>

  <dt>Install</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#boolean">論理値</a></p>
    <p>省略したときは、デフォルトでTrueになります。</p>
    <p><strong>true</strong>のときは、フックのインストールが必要です。</p>
    <p><strong>false</strong>のときは、この関数によって以前に設定された要件はすべて削除され、フックがアンインストールされる可能性があります。</p>
  </dd>

  <dt>Force</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#boolean">論理値</a></p>
    <p>省略されたときは、デフォルトはfalseです。</p>
    <p>If <strong>false</strong>, an internal variable is updated to indicate whether the hook is required by the script, but there might be no immediate change if the hook is required for some other purpose.</p>
    <p>If <strong>true</strong> and <em>Install</em> is true, the hook is uninstalled and reinstalled. これは、他のプロセスによって以前にインストールされたフックよりも優先される効果があります。プログラムが反応しないためにシステムがフックを呼び出さなくなった場合、フックを再インストールすることで再び動作するようになる場合があります。</p>
    <p>If <strong>true</strong> and <em>Install</em> is false, the hook is uninstalled even if needed for some other purpose. <a href="../Hotkeys.htm">ホットキー</a>、<a href="../Hotstrings.htm">ホットストリング</a>、<a href="InputHook.htm">InputHook</a>がフックを必要とする場合、フックが再インストールされるまで動作が停止します。フックの再インストールは、この関数を呼び出すことで明示的に行うことも、ホットキーの有効・無効やフックを必要とする他の関数の呼び出しの副作用として自動的に行うこともできる。</p>
  </dd>

</dl>

<h2 id="Remarks">備考</h2>
<p>マウスフックは、マウスの<a href="../Hotkeys.htm">ホットキー</a>を有効にし、<a href="../Hotstrings.htm#NoMouse">ホットストリングを容易に</a>する目的で、マウスのクリックを監視する。</p>
<p>AutoHotkeyは、キーボードフックとマウスフックを合わせて少なくとも500KBのメモリを消費するため、無条件にインストールしません（ただし、キーボードフックをインストールした場合、マウスフックをインストールしても約50KBの追加メモリしか必要ありません）。したがって、マウスフックは通常、スクリプトに1つまたは複数の<a href="../Hotkeys.htm">マウスホットキー</a>が含まれている場合にのみインストールされます。<a href="../Hotstrings.htm">ホットストリング</a>にもインストールされますが、それは<a href="_Hotstring.htm">#Hotstring NoMouse</a>で無効にすることができます。</p>
<p>これに対して、InstallMouseHook関数を使えば、無条件でマウスフックを設置することができ、以下のような利点があります：</p>
<ul>
  <li><a href="KeyHistory.htm">KeyHistory</a>は、マウスのクリックを監視するために使用することができます。</li>
  <li><a href="GetKeyState.htm">GetKeyState</a>は、ボタンの物理的な状態を取得することができます。</li>
  <li><a href="../Variables.htm#TimeIdleMouse">A_TimeIdleMouse</a>と <a href="../Variables.htm#TimeIdlePhysical">A_TimeIdlePhysical</a>が正しく動作するようになりました（それぞれキーボード入力や人工入力を無視します）。</li>
</ul>
<p>スクリプトがフックを使用しているかどうかは、<a href="KeyHistory.htm">KeyHistory</a>関数またはメニュー項目で確認できます。どのホットキーがフックを使用しているかは、<a href="ListHotkeys.htm">ListHotkeys</a>関数またはメニュー項目で確認することができます。</p>

<h2 id="Related">関連</h2>
<p><a href="InstallKeybdHook.htm">InstallKeybdHook</a>、<a href="_UseHook.htm">#UseHook</a>、<a href="Hotkey.htm">Hotkey</a>、<a href="KeyHistory.htm">KeyHistory</a>、<a href="GetKeyState.htm">GetKeyState</a>、<a href="KeyWait.htm">KeyWait</a></p>
<h2 id="Examples">例</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> マウスフックを無条件でインストールします。</p>
<pre>InstallMouseHook</pre>
</div>

</body>
</html>
