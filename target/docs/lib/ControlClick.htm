<!DOCTYPE HTML>
<html lang="ja">
<head>
<title>ControlClick - 構文と使用法｜AutoHotkey v2</title>
<meta name="description" content="ControlClick関数は、マウスボタンまたはマウスホイールイベントをコントロールに送信します。" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>ControlClick</h1>

<p>マウスボタンまたはマウスホイールイベントをコントロールに送信します。</p>

<pre class="Syntax"><span class="func">ControlClick</span> <span class="optional">Control-or-Pos, WinTitle, WinText, WhichButton, ClickCount, Options, ExcludeTitle, ExcludeText</span></pre>
<h2 id="Parameters">パラメータ</h2>
<dl>

  <dt>Control-or-Pos</dt>
  <dd>
      <p>型：<a href="../Concepts.htm#strings">文字列</a>、<a href="../Concepts.htm#numbers">整数</a>、または<a href="../Objects.htm">オブジェクト</a></p>
      <p>このパラメータが省略された場合、ターゲットウィンドウ自体がクリックされることになる。それ以外の場合は、以下の2つのモードのいずれかが使用されます。</p>
      <p>モード1（ポジション）です。ターゲットウィンドウの<a href="CoordMode.htm#Client">クライアント領域の</a>左上隅を基準としたX、Y座標を指定します。X座標はY座標の前にあり、その間に少なくとも1つのスペースまたはタブが必要です。事例：<code>X55 Y33</code>. 指定された座標にコントロールがある場合、その正確な座標でクリックイベントを送信します。コントロールがない場合は、対象のウィンドウ自体にイベントが送られます（ウィンドウの性質によっては、何の効果もない場合もあります）。</p>
    <p class="note"><strong>注意</strong>：モード1では、<em>Options</em>パラメータのXとYのオプション文字は無視されます。</p>
      <p>モード2（コントロール）です。コントロールの ClassNN、テキスト、HWND、または<code>Hwnd</code>プロパティを持つオブジェクトを指定します。詳しくは、「<a href="Control.htm#Parameter">制御パラメータ</a>」をご覧ください。</p>
      <p>デフォルトでは、モード2がモード1より優先されます。例えば、万が一、テキストやClassNNが「Xnnn Ynnn」の形式を持つコントロールがあった場合、モード2が作用することになる。これを上書きして無条件にモード1を使用するには、次の例のように<em>Options</em>にPosという語を指定します。<code>ControlClick "x255 y152", WinTitle,,,, "Pos"</code>.</p>
  </dd>

  <dt>WinTitle</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a>、<a href="../Concepts.htm#numbers">整数</a>、または<a href="../Objects.htm">オブジェクト</a></p>
    <p>ウィンドウのタイトルなど、対象のウィンドウを特定する条件。<a href="../misc/WinTitle.htm">WinTitleを</a>参照してください。</p>
  </dd>

  <dt>WinText</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
    <p>存在する場合、このパラメータは、ターゲットウィンドウの単一のテキスト要素からの部分文字列でなければなりません（付属のWindow Spyユーティリティによって明らかにされます）。<a href="DetectHiddenText.htm">DetectHiddenText</a>がONの場合、隠しテキスト要素が検出されます。</p>
  </dd>

  <dt>WhichButton</dt>
  <dd>
      <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
      <p>クリックするボタンです。LEFT、RIGHT、MIDDLE（またはそれぞれの頭文字のみ）。省略または空白の場合、LEFTボタンが使用されます。</p>
      <p>X1（XButton1、マウス第4ボタン）、X2（XButton2、マウス第5ボタン）にも対応しています。</p>
      <p>WheelUp（WU）、WheelDown（WD）、WheelLeft（WL）、WheelRight（WR）にも対応しています。この場合、<em>ClickCount</em>はホイールを回すためのノッチ数です。</p>
    </dd>

  <dt>ClickCount</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#numbers">整数</a></p>
    <p>送信するクリック数です。省略または空白の場合は、1クリック送信されます。</p>
  </dd>

  <dt>オプション</dt>
  <dd>
      <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
      <p>以下のオプション文字のうち、0個以上を連続させたもの。事例：d x50 y25</p>
      <p><strong>NA</strong>:信頼性を向上させる可能性がある。以下の<a href="#Reliability">信頼性</a>をご参照ください。</p>
      <p><strong>D</strong>:マウスボタンを押しながら離さない（ダウンイベントを発生させる）。<strong>D</strong>と <strong>U</strong>の両方のオプションがない場合、完全なクリック（下と上）が送信されます。</p>
      <p><strong>U</strong>:マウスボタンを離す（つまりアップイベントを発生させる）。<strong>D</strong>オプションがすでに存在する場合、このオプションは存在してはならない（その逆も同様）。</p>
      <p><strong>Pos</strong>:Posという単語を<em>Options</em>のどこかに指定すると、上記の<em>Control-or-Pos</em>パラメータで説明したX/Yポジショニングモードを無条件に使用することができます。</p>
      <p><strong>Xn</strong>:コントロールの左上隅を基準として、クリックする X 位置を<strong>n</strong>に指定します。未指定の場合、クリックはコントロールの水平方向の中心で行われます。</p>
      <p><strong>Yn</strong>:コントロールの左上隅を基準として、クリックするY位置を<strong>n</strong>に指定します。未指定の場合、クリックはコントロールの垂直方向の中心で行われます。</p>
      <p><strong>X</strong>と <strong>Y</strong>のオプションには、10進数（16進数ではない）を使用します。</p>
  </dd>

  <dt>ExcludeTitle</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
    <p>タイトルにこの値が含まれているWindowsは、審査対象外となります。</p>
  </dd>

  <dt>ExcludeText</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
    <p>テキストにこの値が含まれているウィンドウは、検討の対象外となります。</p>
  </dd>

</dl>

<h2 id="Error_Handling">エラー処理</h2>
<p>以下の場合は例外が発生します。</p>
<ul>
  <li><a href="Error.htm#TargetError">TargetError</a>:対象のウィンドウが見つかりませんでした。</li>
  <li><a href="Error.htm#TargetError">TargetError</a>:対象コントロールが見つからず、<em>Control-or-Pos</em>で有効な位置が指定されていない。</li>
  <li><a href="Error.htm#OSError">OSError</a> (very rare):の場合、X または Y の位置が省略され、コントロールの位置を決定することができなかった。</li>
  <li><a href="Error.htm#ValueError">ValueError</a> または <a href="Error.htm#TypeError">TypeError</a>:無効なパラメータが検出されました。</li>
</ul>

<h2 id="Reliability">Reliability</h2>
<p>信頼性を高めるために、特にControlClick中にユーザーが物理的にマウスを動かしている場合、以下のどちらか、または両方が有効です。</p>
<p>1)ControlClickの前に<code><a href="SetControlDelay.htm">SetControlDelay</a>-1</code>を使ってください。これにより、クリック中にマウスボタンを押し続けることがなくなり、ユーザーのマウスの物理的な動きによる干渉を軽減することができます。</p>
<p>2)以下のように、第6パラメータ（<em>Options</em>）の任意の場所に文字列NAを指定します。</p>
<pre>SetControlDelay -1
ControlClick "Toolbar321", WinTitle,,,, "NA"</pre>
<p><code>NA</code>は、ターゲットウィンドウをアクティブとしてマークすることを避け、その入力処理をスクリプトのそれと統合することを避けるため、マウスの物理的な動きが干渉しない場合があります（ただし、通常はターゲットウィンドウがアクティブでない場合のみ）。ただし、この方法は、すべての種類のウィンドウやコントロールに有効とは限りません。</p>
<h2 id="Remarks">備考</h2>
<p>すべてのアプリケーションが、マウスホイールの回転に対して1以上の<em>ClickCount</em>を指定するわけではありません。そのような場合は、この例のようにLoopを使ってホイールを1ノッチ以上回し、5ノッチ分回してください。</p>
<pre>Loop 5
    ControlClick <i>Control</i>, <i>WinTitle</i>, <i>WinText</i>, "WheelUp"</pre>
<p>ウィンドウのタイトルとテキストは大文字と小文字が区別されます。<a href="DetectHiddenWindows.htm">DetectHiddenWindows</a>がオンになっていない限り、隠しウィンドウは検出されません。</p>

<h2 id="Related">関連</h2>
<p><a href="SetControlDelay.htm">SetControlDelay</a>, <a href="Control.htm">Control functions</a>, <a href="Click.htm">Click</a></p>
<h2 id="Examples">例</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> OKボタンをクリックします。</p>
<pre>ControlClick "OK"、"Some Window Title"</pre>
</div>

<div class="ex" id="ExCoord">
<p><a class="ex_number" href="#ExCoord"></a> 座標のセットでクリックします。XとYの間にコンマがないことに注意してください。</p>
<pre>ControlClick "x55 y77", "Some Window Title"</pre>
</div>

<div class="ex" id="ExReliability">
<p><a class="ex_number" href="#ExReliability"></a> NAモードでは、指定したコントロールからの相対座標でクリックします。</p>
<pre>SetControlDelay -1  <em>; 信頼性を向上させ、副作用を低減させることができる。</em>
ControlClick "Toolbar321", "Some Window Title",,,, "NA x192 y10"</pre>
</div>

</body>
</html>
