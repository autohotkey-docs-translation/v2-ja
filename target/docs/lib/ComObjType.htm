<!DOCTYPE HTML>
<html lang="ja">
<head>
<title>ComObjType - 構文と使用法｜AutoHotkey v2</title>
<meta name="description" content="ComObjType 関数は、COM オブジェクトから型情報を取得します。" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>ComObjType</h1>

<p>COM オブジェクトから型情報を取得します。</p>

<pre class="Syntax">Info := <span class="func">ComObjType</span>(ComObj <span class="optional">, InfoType</span>)</pre>

<h2 id="Parameters">パラメータ</h2>
<dl>

  <dt>ComObj</dt>
  <dd>
    <p>Type: <a href="../Concepts.htm#objects">Object</a></p>
    <p>COMオブジェクトまたは型付き値を含むラッパーオブジェクト。詳しくは<a href="ComValue.htm">ComValue</a>をご覧ください。</p>
  </dd>

  <dt>InfoType</dt>
  <dd>
    <p>Type: <a href="../Concepts.htm#strings">String</a></p>
    <p>If omitted, an integer <a href="#vt">variant type code</a> indicating the type of value contained by the COM wrapper object will be retrieved. Otherwise, specify one of the following strings indicating the type information to retrieve:</p>
    <p><strong>Name:</strong> The name of the object's default interface.</p>
    <p><strong>IID:</strong> The globally unique identifier (GUID) of the object's default interface.</p>
    <p><strong>Class:</strong> The object's class name. Note that this is not the same as a Prog ID (a Prog ID is a name used to identify the class in the system registry, or for <a href="ComObject.htm">ComObject</a>).</p>
    <p><strong>CLSID:</strong> The globally unique identifier (GUID) of the object's class. Classes are often registered by CLSID under the <code>HKCR\CLSID</code> registry key.</p>
  </dd>

</dl>

<h2 id="Return_Value">戻り値</h2>
<p>Type: <a href="../Concepts.htm#numbers">Integer</a> or <a href="../Concepts.htm#strings">String</a></p>
<p>The return value depends on the value of <em>InfoType</em>. いずれかのパラメータが無効な場合、または要求された型情報を取得できなかった場合は、空文字列が返されます。</p>

<h2 id="vt">バリアント型定数</h2>
<p>COMは、基本的なデータ型を識別するために、以下の値を使用します。</p>
<pre>
VT_EMPTY     :=      0  <em>; No value</em>
VT_NULL      :=      1  <em>; SQL-style Null</em>
VT_I2        :=      2  <em>; 16-bit signed int</em>
VT_I4        :=      3  <em>; 32-bit signed int</em>
VT_R4        :=      4  <em>; 32-bit floating-point number</em>
VT_R8        :=      5  <em>; 64-bit floating-point number</em>
VT_CY        :=      6  <em>; Currency</em>
VT_DATE      :=      7  <em>; Date</em>
VT_BSTR      :=      8  <em>; COM string (Unicode string with length prefix)</em>
VT_DISPATCH  :=      9  <em>; COM object</em>
VT_ERROR     :=    0xA  <em>; Error code (32-bit integer)</em>
VT_BOOL      :=    0xB  <em>; Boolean True (-1) or False (0)</em>
VT_VARIANT   :=    0xC  <em>; <a href="https://learn.microsoft.com/windows/win32/api/oaidl/ns-oaidl-variant">VARIANT</a> (must be combined with VT_ARRAY or VT_BYREF)</em>
VT_UNKNOWN   :=    0xD  <em>; IUnknown interface pointer</em>
VT_DECIMAL   :=    0xE  <em>; (not supported)</em>
VT_I1        :=   0x10  <em>; 8-bit signed int</em>
VT_UI1       :=   0x11  <em>; 8-bit unsigned int</em>
VT_UI2       :=   0x12  <em>; 16-bit unsigned int</em>
VT_UI4       :=   0x13  <em>; 32-bit unsigned int</em>
VT_I8        :=   0x14  <em>; 64-bit signed int</em>
VT_UI8       :=   0x15  <em>; 64-bit unsigned int</em>
VT_INT       :=   0x16  <em>; Signed machine int</em>
VT_UINT      :=   0x17  <em>; Unsigned machine int</em>
VT_RECORD    :=   0x24  <em>; User-defined type -- NOT SUPPORTED</em>
VT_ARRAY     := 0x2000  <em>; <a href="https://learn.microsoft.com/windows/win32/api/oaidl/ns-oaidl-safearray">SAFEARRAY</a></em>
VT_BYREF     := 0x4000  <em>; Pointer to another type of value</em>
<em>/*
 VT_ARRAYとVT_BYREFを別の値と結合する（ビット単位のOR使用）
 to specify the exact type. For instance, 0x2003 identifies a <a href="https://learn.microsoft.com/windows/win32/api/oaidl/ns-oaidl-safearray">SAFEARRAY</a>
 は 32 ビット符号付き整数、0x400C は<a href="https://learn.microsoft.com/windows/win32/api/oaidl/ns-oaidl-variant">VARIANT</a>へのポインタを示します。
*/</em>
</pre>

<h2 id="General_Remarks">総論</h2>
<p>ほとんどの場合、COMオブジェクトのメソッドまたはプロパティからの戻り値は、AutoHotkeyがサポートする適切なデータ型に変換されます。特に扱われていない型は、<a href="https://learn.microsoft.com/windows/win32/api/oleauto/nf-oleauto-variantchangetype">VariantChangeType</a>によって文字列に強制されます。もしこれが失敗したり、Variant型にVT_ARRAYやVT_BYREFフラグが含まれている場合、代わりに値とその型の両方を含むオブジェクトが返されます。</p>
<p>任意の変数<i>x</i>に対して、<code>ComObjType(x)</code>が整数を返す場合、<i>x</i>はCOMオブジェクトラッパーを含む。</p>
<p>If <em>InfoType</em> is <code>"Name"</code> or <code>"IID"</code>, type information is retrieved via the <a href="https://learn.microsoft.com/windows/win32/api/oaidl/nf-oaidl-idispatch-gettypeinfo">IDispatch::GetTypeInfo</a> interface method. <em>ComObj</em>のバリアントタイプはVT_DISPATCHでなければならない。</p>
<p>If <em>InfoType</em> is <code>"Class"</code> or <code>"CLSID"</code>, type information is retrieved via the <a href="https://learn.microsoft.com/windows/win32/api/ocidl/nf-ocidl-iprovideclassinfo-getclassinfo">IProvideClassInfo::GetClassInfo</a> interface method. <em>ComObjの</em>バリアントタイプはVT_DISPATCHまたはVT_UNKNOWNでなければならず、オブジェクトはIProvideClassInfoインターフェースを実装しなければならない（実装していないオブジェクトもある）。</p>

<h2 id="Related">関連</h2>
<p><a href="ComObjValue.htm">ComObjValue</a>, <a href="ComValue.htm">ComValue</a>, <a href="ComObject.htm">ComObject</a>, <a href="ComObjGet.htm">ComObjGet</a>, <a href="ComObjActive.htm">ComObjActive</a></p>

<h2 id="Examples">例</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> COMオブジェクトの各種型情報を報告します。</p>
<pre>
d := ComObject("Scripting.Dictionary")
MsgBox
(
    "Variant type:`t" ComObjType(d) "
    Interface name:`t" ComObjType(d, "Name") "
    Interface ID:`t" ComObjType(d, "IID") "
    Class name:`t" ComObjType(d, "Class") "
    Class ID (CLSID):`t" ComObjType(d, "CLSID")
)</pre>
</div>

</body>
</html>
