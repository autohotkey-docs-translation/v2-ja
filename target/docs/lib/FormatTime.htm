<!DOCTYPE HTML>
<html lang="ja">
<head>
<title>FormatTime - 構文と使用法｜AutoHotkey v2</title>
<meta name="description" content="FormatTime 関数は、YYYYMMDDHH24MISS のタイムスタンプを指定された日付/時刻形式に変換します。" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<style type="text/css">
.red {color: #FF0000}
</style>
</head>
<body>

<h1>FormatTime</h1>

<p><a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>タイムスタンプを指定された日付/時刻形式に変換します。</p>

<pre class="Syntax">String := <span class="func">FormatTime</span>(<span class="optional">YYYYMMDDHH24MISS, Format</span>)</pre>
<h2 id="Parameters">パラメータ</h2>
<dl>

  <dt>YYYYMMDDHH24MISS</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">String</a></p>
    <p>空白または省略された場合、現在のローカルタイムがデフォルトとなります。それ以外の場合は、<a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>形式のタイムスタンプの全部または先頭部分を指定します。</p>
  </dd>

  <dt>Format</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">String</a></p>
    <p>If blank or omitted, it defaults to the time followed by the long date, both of which will be formatted according to the current user's locale. 事例：4:55 PM Saturday, November 27, 2004</p>
    <p>それ以外の場合は、以下の表から1つ以上の日付時刻形式を指定し、その間にリテラルスペースと句読点を入れる（カンマはエスケープする必要はなく、通常通り使用できる）。以下の例では、Mは必ず大文字にすることに注意してください：M/d/yyyy h:mm tt</p>
  </dd>

</dl>

<h2 id="Return_Value">戻り値</h2>
<p>型：<a href="../Concepts.htm#strings">String</a></p>
<p>説明： 指定されたタイムスタンプを変換したものを返す。</p>
<p><em>YYYYMMDDHH24MISS</em>に無効な日付・時刻部分（うるう年の2月29日など）が含まれる場合、その日付・時刻は戻り値から除外されます。1601年から9999年までの年号のみがサポートされていますが、時刻部分が有効である限り、それ以前の年号でもフォーマットされた時刻を作成することができます。</p>
<p><em>Format</em>が2000文字以上の場合は、空文字列を返します。</p>

<h2 id="Date_Formats">Date Formats (case-sensitive)</h2>
<table class="info">
  <tr>
    <th style="width:15%">Format</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>d</td>
    <td>先頭のゼロを除いた月日（1～31）。</td>
  </tr>
  <tr>
    <td>dd</td>
    <td>月日（先頭がゼロの場合）（01～31</td>
  </tr>
  <tr>
    <td>ddd</td>
    <td>現在のユーザーの言語における曜日の略称（例：Mon）。</td>
  </tr>
  <tr>
    <td>dddd</td>
    <td>現在のユーザーの言語での曜日（例：月曜日）を表すフルネーム</td>
  </tr>
  <tr>
    <td>M</td>
    <td>先頭のゼロを除いた月（1～12）</td>
  </tr>
  <tr>
    <td>MM</td>
    <td>月（先頭がゼロの場合）（01～12</td>
  </tr>
  <tr>
    <td>MMM</td>
    <td>現在のユーザーの言語での月名の略称（例：Jan）。</td>
  </tr>
  <tr>
    <td>MMMM</td>
    <td>現在のユーザーの言語での完全な月名（例：1月）。</td>
  </tr>
  <tr>
    <td>y</td>
    <td>年（世紀なし）、先頭ゼロなし（0～99）。</td>
  </tr>
  <tr>
    <td>yy</td>
    <td>年（世紀なし）、先頭ゼロ（00～99）。</td>
  </tr>
  <tr>
    <td>yyyy</td>
    <td>世紀を含む年。事例：2005</td>
  </tr>
  <tr>
    <td>gg</td>
    <td>現在のユーザーのロケールに対応する時代・年代の文字列（ない場合は空白）。</td>
  </tr>
</table>
<h2 id="Time_Formats">Time Formats (case-sensitive)</h2>
<table class="info">
  <tr>
    <th style="width:15%">Format</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>h</td>
    <td>時間（先頭のゼロを除く）、12時間形式（1〜12</td>
  </tr>
  <tr>
    <td>hh</td>
    <td>時間（先頭ゼロ）、12時間形式（01～12</td>
  </tr>
  <tr>
    <td>H</td>
    <td>時間（先頭のゼロを除く）、24時間形式（0～23</td>
  </tr>
  <tr>
    <td>HH</td>
    <td>時間（先頭ゼロ）、24時間形式（00～23</td>
  </tr>
  <tr>
    <td>m</td>
    <td>分（先頭のゼロを除く）（0～59</td>
  </tr>
  <tr>
    <td>mm</td>
    <td>先頭がゼロの分（00～59）</td>
  </tr>
  <tr>
    <td>s</td>
    <td>秒数（先頭ゼロなし）（0～59</td>
  </tr>
  <tr>
    <td>ss</td>
    <td>ゼロを先頭に持つ秒数（00～59）</td>
  </tr>
  <tr>
    <td>t</td>
    <td>AやPなどの1文字のタイムマーカー（ロケールにより異なる）</td>
  </tr>
  <tr>
    <td>tt</td>
    <td>AMやPMなどの複数文字のタイムマーカー（ロケールにより異なる）</td>
  </tr>
</table>
<h2 id="Standalone_Formats">スタンドアロン型フォーマット</h2>
  <p>以下のフォーマットは<strong>単独</strong>で使用する必要があります。つまり、<em>Format</em>パラメータに他のフォーマットやテキストが存在しない状態で使用します。These formats are not case-sensitive.</p>
<table class="info">
  <tr>
    <th style="width:15%">Format</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>(Blank)</td>
    <td><em>Format</em>を空白にすると、時刻の後に長い日付が表示されます。例えば、ある地域では、2004年11月27日（土）午後4時55分と表示されるかもしれません。</td>
  </tr>
  <tr>
    <td>Time</td>
    <td>現在のユーザーのロケールでの時間表現（午後5時26分など</td>
  </tr>
  <tr>
    <td>ShortDate</td>
    <td>02/29/04のように、現在のユーザーのロケールに対応した短い日付表現。</td>
  </tr>
  <tr>
    <td>LongDate</td>
    <td>2004年4月23日（金）のように、現在のユーザーのロケールに対応した長い日付表現</td>
  </tr>
  <tr>
    <td>YearMonth</td>
    <td>2004年2月など、現在のユーザーのロケールに合わせた年・月のフォーマット</td>
  </tr>
  <tr>
    <td>YDay</td>
    <td>先頭のゼロを除いた西暦の日（1～366日）</td>
  </tr>
  <tr>
    <td>YDay0</td>
    <td>先頭のゼロを含む西暦の日（001～366）</td>
  </tr>
  <tr>
    <td>WDay</td>
    <td>曜日（1～7）です。日曜日は1.</td>
  </tr>
  <tr>
    <td>YWeek</td>
    <td>ISO 8601の完全な年号と週番号を示します。事例：200453. 新年1月1日を含む週が4日以上ある場合は、第1週とします。それ以外は前年の最終週となり、次週は第1週となります。その結果、1月4日と1月第1木曜日は、いずれも必ず第1週になります。</td>
  </tr>
</table>
<h2 id="Additional_Options">追加オプション</h2>
<p><em>YYYYMMDDHH24MISS</em>パラメータ内では、タイムスタンプの直後に以下のオプションを表示することができます（タイムスタンプがない場合は、これらのオプションのみを使用することができます）。次の例では、最後の4つの項目の間にコンマがないことに注意してください：</p>
<pre>OutputVar := FormatTime("20040228 LSys D1 D4")</pre>
<p><strong>R:</strong> Reverse. 日付が時間の前に来るようにする（<em>Format</em>が空白のときのみ意味があります）。</p>
<p><strong>Ln:</strong> If this option is <em>not</em> present, the current user's locale is used to format the string. 代わりにシステムのロケールを使用する場合は、LSysを指定します。特定のロケールを使用する場合は、文字Lの後に16進数または10進数のロケール識別子（LCID）を指定してください。LCIDの構築方法については、<a href="https://www.microsoft.com">www.microsoft.com</a>、以下のフレーズで検索してください：Locale Identifiers</p>
<p><strong>Dn:</strong> Date options. <strong>n</strong>には、次のいずれかの数字を指定する：</p>
<ul>
  <li>0 = デフォルトのオプションを強制的に使用します。これによって、ショートデイトも有効になります。</li>
  <li>1 = 短い日付を使用する（<em>Format</em>が空白の場合のみ意味があります。）</li>
  <li>2 = 長い日付を使用する（<em>Format</em>が空白の場合のみ意味がある、1および8とは互換性がない）。</li>
  <li>4 = 代替カレンダーを使用する（ある場合）。</li>
  <li>8 = 年月日形式を使用する（<em>Format</em>が空白の場合のみ意味がある、1および2とは互換性がない）。</li>
  <li>0x10 = 左から右への読み順レイアウトのためのマークを追加します。</li>
  <li>0x20 = 右から左への読み順レイアウトのためのマークを追加します。</li>
  <li>0x80000000 = システムのデフォルトの日付フォーマットに対して、ユーザーが有効にしているオーバーライドに従わない。</li>
  <li>0x40000000 = 文字列の変換にロケールのコードページではなく、システムのANSIコードページを使用します。</li>
</ul>
<p><strong>Tn:</strong> Time options. <strong>n</strong>には、次のいずれかの数字を指定する：</p>
<ul>
  <li>0 = デフォルトのオプションを強制的に使用します。これにより、分と秒が表示されるようにもなります。</li>
  <li>1 = 分と秒を省略します。</li>
  <li>2 = 秒を省略します。</li>
  <li>4 = タイムマーカーを省略します（例：AM/PM）。</li>
  <li>8 = 12時間制ではなく、常に24時間制を採用しています。</li>
  <li>12 = 上記2つの組み合わせ。</li>
  <li>0x80000000 = システムのデフォルトの時間フォーマットに対して、ユーザーが有効にしているオーバーライドに従わない。</li>
  <li>0x40000000 = 文字列の変換にロケールのコードページではなく、システムのANSIコードページを使用します。</li>
</ul>
<p class="note"><strong>Note:</strong> Dn and Tn may be repeated to put more than one option into effect, such as this example: <code>FormatTime("20040228 D2 D4 T1 T8")</code></p>
<h2 id="Remarks">備考</h2>
<p><em>Format</em>から最終的な文字列に文字通りに転写したい文字や数字は、この例のようにシングルクォートで囲む必要があります：<code>"'Date:' MM/dd/yy 'Time:' hh:mm:ss tt"</code>.</p>
<p>一方、スペース、タブ、ラインフィード（`n）、スラッシュ、コロン、カンマ、その他の句読点などの非英数字は、シングルクォートで囲む必要はない。ただし、シングルクォート文字そのものは例外です：を文字通りに表示するには、4つの連続した単一引用符（'''）を使用します（引用符がすでに外側の引用符のペアの中にある場合は2つだけ）。</p>
<p><em>Formatが</em>日付と時刻の要素を一緒に含む場合、両者を混在させてはならない。つまり、文字列は2つに分割できることが望ましいのです：時間半分、日付半分。例えば、"hh yyyy mm"で構成されるフォーマット文字列は、2つの時間要素の間に日付要素があるため、期待した結果を得ることはできません。</p>
<p><em>Format</em>に数値の月日（dまたはdd）の後に完全な月名（MMMM）が含まれる場合、月名の主格が使用される（言語に主格がある場合）。</p>
<p>これに関連して、日時の加算、減算、比較は<a href="DateAdd.htm">DateAdd</a>と <a href="DateDiff.htm">DateDiff</a>で行うことができます。</p>
<h2 id="Related">関連</h2>
<p>逆方向の変換、つまり、フォーマットされた日付/<em>時刻</em>から <a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a> <em>フォーマット</em>への変換は、<a href="https://www.autohotkey.com/forum/topic20405.html">www.autohotkey.com/forum/topic20405.html</a>をご覧ください。</p>
<p>こちらもご覧ください：<a href="GuiControls.htm#DateTime">Gui DateTime control</a>, <a href="Format.htm">Format</a>, <a href="../Variables.htm#date">built-in date and time variables</a>, <a href="FileGetTime.htm">FileGetTime</a></p>
<h2 id="Examples">例</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> さまざまな使い方を実演します。</p>
<pre>TimeString := FormatTime()
MsgBox "The current time and date (time first) is " TimeString

TimeString := FormatTime("R")
MsgBox "The current time and date (date first) is " TimeString

TimeString := FormatTime(, "Time")
MsgBox "The current time is " TimeString

TimeString := FormatTime("T12", "Time")
MsgBox "The current 24-hour time is " TimeString

TimeString := FormatTime(, "LongDate")
MsgBox "The current date (long format) is " TimeString

TimeString := FormatTime(20050423220133, "dddd MMMM d, yyyy hh:mm:ss tt")
MsgBox "The specified date and time, when formatted, is " TimeString

MsgBox FormatTime(200504, "'Month Name':MMMM`n'Day Name':dddd")

YearWeek := FormatTime(20050101, "YWeek")
MsgBox "January 1st of 2005 is in the following ISO year and week number:"年 週間</pre>
</div>

<div class="ex" id="ExFileTime">
<p><a class="ex_number" href="#ExFileTime"></a> ファイルの日付・タイムスタンプを変更します。</p>
<pre>FileName := FileSelect(3,, "Pick a file")
if FileName = "" <em>; The user didn't pick a file.</em>
    return
FileTime := FileGetTime(FileName)
FileTime := FormatTime(FileTime)   <em>; Since the last parameter is omitted, the long date and time are retrieved.</em>
MsgBox "The selected file was last modified at " FileTime</pre>
</div>

<div class="ex" id="ExFormatSec">
<p><a class="ex_number" href="#ExFormatSec"></a> 指定された秒数を、対応する時・分・秒数（hh:mm:ss形式）に変換します。</p>
<pre>MsgBox FormatSeconds(7384)  <em>; 7384 = 2 hours + 3 minutes + 4 seconds. It yields:2:03:04</em>

FormatSeconds(NumberOfSeconds)  <em>; Convert the specified number of seconds to hh:mm:ss format.</em>
{
    time := 19990101  <em>; *Midnight* of an arbitrary date.</em>
    time := DateAdd(time, NumberOfSeconds, "Seconds")
    return NumberOfSeconds//3600 ":" FormatTime(time, "mm:ss")
    <em>/*
    ; 上記の方法とは異なり、24時間分以上の秒数をサポートすることはできません：
return FormatTime(time, "h:mm:ss")
    */</em>
}</pre>
</div>

</body>
</html>
