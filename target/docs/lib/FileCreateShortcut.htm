<!DOCTYPE HTML>
<html lang="ja">
<head>
<title>FileCreateShortcut - 構文と使用法｜AutoHotkey v2</title>
<meta name="description" content="FileCreateShortcut関数は、ショートカット（.lnk）ファイルを作成します。" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>FileCreateShortcut</h1>

<p>ショートカット（.lnk）ファイルを作成します。</p>

<pre class="Syntax"><span class="func">FileCreateShortcut</span> Target, LinkFile <span class="optional">, WorkingDir, Args, Description, IconFile, ShortcutKey, IconNumber, RunState</span></pre>
<h2 id="Parameters">パラメータ</h2>
<dl>

  <dt>Target</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
    <p>ショートカットが参照するファイルの名前。そのファイルがシステムと統合されていない限り、絶対パスを含める必要があります（例：Notepad.exe）。ショートカットの作成時にファイルが存在する必要はありませんが、存在しない場合、システムによっては<a href="https://devblogs.microsoft.com/oldnewthing/20180509-00/?p=98715">予期せぬ方法でパス</a>が変更される可能性があります。</p>
  </dd>

  <dt>LinkFile</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
    <p>作成するショートカットファイルの名前。絶対パスが指定されていない場合は、<a href="../Variables.htm#WorkingDir">A_WorkingDir</a>にあると仮定されます。必ず拡張子<strong>.lnk</strong>を付けてください。保存先ディレクトリはすでに存在している必要があります。ファイルがすでに存在する場合は、上書きされます。</p>
  </dd>

  <dt>WorkingDir</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
    <p>ショートカットの起動時に<em>Target</em>のカレントワーキングディレクトリとなるディレクトリです。空白または省略された場合、ショートカットの "Start in" フィールドは空白となり、ショートカットの起動時にシステムがデフォルトの作業ディレクトリを提供することになります。</p>
  </dd>

  <dt>Args</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
    <p><em>Target</em>の起動時に渡されるパラメータです。パラメータはスペースで区切ってください。パラメータにスペースが含まれる場合は、二重引用符で囲んでください。</p>
  </dd>

  <dt>説明</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
    <p>ショートカットを説明するコメント（OSがツールチップを表示するときなどに使用する）</p>
  </dd>

  <dt>IconFile</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
    <p><em>LinkFile</em>に表示するアイコンのフルパスと名前です。icoファイルか、EXEまたはDLLの一番最初のアイコンである必要があります。</p>
  </dd>

  <dt>ShortcutKey</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
    <p>文字、数字、または<a href="../KeyList.htm">キーリスト</a>の中から1つのキーの名前（マウスボタンやその他の非標準的なキーはサポートされない場合があります）。修飾語記号は<strong>含めない</strong>でください。現在、すべてのショートカットキーは<kbd>Ctrl</kbd>+<kbd>Alt</kbd> ショートカットとして作成されています。例えば、このパラメータに文字Bを指定した場合、ショートカットキーは<kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>B</kbd>となります。</p>
  </dd>

  <dt>IconNumber</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#numbers">整数</a></p>
    <p><em>IconFile</em>にあるアイコンのうち、先頭以外のアイコンを使用する場合は、ここでその番号を指定します。例えば、2は2番目のアイコンです。</p>
  </dd>

  <dt>RunState</dt>
  <dd>
    <p>型：<a href="../Concepts.htm#numbers">整数</a></p>
    <p>起動した<em>Target</em>を最小化または最大化します。省略された場合、デフォルトは1（通常）です。それ以外の場合は、以下の数字のいずれかを指定してください：</p>
    <ul>
      <li>1 = Normal</li>
      <li>3 = Maximized</li>
      <li>7 = Minimized</li>
    </ul>
  </dd>

</dl>
<h2 id="Error_Handling">エラー処理</h2>
<p>失敗した場合は例外が発生します。</p>

<h2 id="Remarks">備考</h2>
<p>ターゲットファイルがシステムのPATH環境変数にリストされたフォルダのいずれかに存在する場合、<em>ターゲット</em>にパスを含める必要がない場合があります。</p>
<p>新しく作成したショートカットの<em>ShortcutKey</em>は、ショートカットファイルがデスクトップまたはスタートメニューのどこかに存在しない限り、何の効果もありません。選択した<em>ShortcutKey</em>がすでに使用されている場合は、新しい<em>ShortcutKey</em>が優先されます。</p>
<p>別の方法として、特別なURLのショートカットを作成する次の例もあります。最初の2つのパラメータは、好みに合わせて変更してください：</p>
<pre><a href="IniWrite.htm">IniWrite</a> "https://www.google.com", "C:\My Shortcut.url", "InternetShortcut", "URL"</pre>
<p>上記に対して、アイコンを付与するために、以下を任意に追加することができる：</p>
<pre><a href="IniWrite.htm">IniWrite</a> &lt;IconFile&gt;, "C:\My Shortcut.url", "InternetShortcut", "IconFile"
<a href="IniWrite.htm">IniWrite</a> 0, "C:\My Shortcut.url", "InternetShortcut", "IconIndex"</pre>
<p>上記で、<code>0</code>をアイコンのインデックスに置き換え（最初のアイコンには0が使われる）、その代わりに <code>&lt;IconFile&gt;</code>を、URL、EXE、DLL、ICO ファイルと一緒に送信します。例：<code>"C:\Icons.dll"</code>, <code>"C:\App.exe"</code>, <code>"https://www.somedomain.com/ShortcutIcon.ico"</code></p>
<p>OSは、.LNKファイルではなくプレーンテキストファイルであっても、上記によって作成された.URLファイルを本物のショートカットとして扱います。</p>
<h2 id="Related">関連</h2>
<p><a href="FileGetShortcut.htm">FileGetShortcut</a>, <a href="FileAppend.htm">FileAppend</a></p>
<h2 id="Examples">例</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> 最後のパラメーターに "i "を入れると、ショートカットキーが<kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>I</kbd>になります。</p>
<pre>FileCreateShortcut "Notepad.exe", A_Desktop "\My Shortcut.lnk", "C:³", A_ScriptFullPath, "My Description", "C:³My Icon.ico", "i"</pre>
</div>

</body>
</html>
