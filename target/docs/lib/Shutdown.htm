<!DOCTYPE HTML>
<html lang="ja">
<head>
<title>Shutdown - 構文と使用法｜AutoHotkey v2</title>
<meta name="description" content="シャットダウン機能は、システムのシャットダウン、再起動、ログオフを行います。" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>Shutdown</h1>

<p>システムのシャットダウン、再起動、ログオフを行います。</p>

<pre class="Syntax"><span class="func">Shutdown</span> Flag</pre>
<h2 id="Parameters">パラメータ</h2>
<dl>

  <dt>Flag</dt>
  <dd>
    <p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
    <p>以下の数字の組み合わせ（合計）：</p>
    <ul>
      <li>0 = Logoff</li>
      <li>1 = Shutdown</li>
      <li>2 = Reboot</li>
      <li>4 = Force</li>
      <li>8 = Power down</li>
    </ul>
    <p>必要な値を足し合わせる。例えば、シャットダウンとパワーダウンの場合、フラグは9となる（シャットダウン＋パワーダウン＝1＋8＝9）。</p>
    <p>"Force"値（4）は、開いているすべてのアプリケーションを強制的に閉じます。開いているアプリケーションがデータを失う可能性があるため、緊急時のみ使用すること。</p>
    <p>"Power down"値（8）はシステムをシャットダウンし、電源を切る。</p>
  </dd>

</dl>

<h2 id="Remarks">備考</h2>
<p>システムをサスペンドまたはハイバネートにするには、このページの下にある<a href="#ExSuspend">例2</a>を参照してください。</p>
<p>モニターをオフにするには、<a href="SendMessage.htm#ExMonitorPower">SendMessageの例#1</a>を参照。</p>
<p>これに関連して、スクリプトは、システムがシャットダウンするときや、ユーザーが<a href="OnExit.htm">OnExit</a>を介してログオフするときを検出することができます。</p>
<h2 id="Related">関連</h2>
<p><a href="Run.htm">Run</a>, <a href="ExitApp.htm">ExitApp</a>, <a href="OnExit.htm">OnExit</a></p>
<h2 id="Examples">例</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> Forces a reboot (reboot + force = 2 + 4 = 6).</p>
<pre>Shutdown 6</pre>
</div>

<div class="ex" id="ExSuspend">
<p><a class="ex_number" href="#ExSuspend"></a> Windows API関数 "SetSuspendState "を呼び出し、システムをサスペンドまたは休止状態にします。なお、2番目のパラメータは、新しいシステムではまったく効果がない場合があります。</p>
<pre><em>; Parameter #1: Pass 1 instead of 0 to hibernate rather than suspend.
; Parameter #2: Pass 1 instead of 0 to suspend immediately rather than asking each application for permission.
; Parameter #3: Pass 1 instead of 0 to disable all wake events.</em>
DllCall("PowrProf\SetSuspendState", "Int", 0, "Int", 0, "Int", 0)</pre>
</div>

</body>
</html>
