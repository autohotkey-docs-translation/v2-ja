<!DOCTYPE HTML>
<html lang="jac">
<head>
<title>Shutdown - 構文と使用法｜AutoHotkey v2</title>
<meta name="description" content="シャットダウン関数は、システムのシャットダウン、再起動、ログオフを行います。" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>Shutdown</h1>

<p>システムのシャットダウン、再起動、ログオフを行います。</p>

<pre class="Syntax"><span class="func">Shutdown</span> Flag</pre>
<h2 id="Parameters">パラメータ</h2>
<dl>

  <dt>Flag</dt>
  <dd>
    <p>Type: <a href="../Concepts.htm#numbers">Integer</a></p>
    <p>以下の数字の組み合わせ（合計）：</p>
    <ul>
      <li>0 = ログオフ</li>
      <li>1 = シャットダウン</li>
      <li>2 = 再起動</li>
      <li>4 = 警告せずに閉じる</li>
      <li>8 = 電源オフ</li>
    </ul>
    <p>必要な値を足し合わせます。例えば、シャットダウンと電源オフの場合、フラグは9となります（シャットダウン＋電源おフ＝1＋8＝9）。</p>
    <p>「警告せずに閉じる」（4）は、開いている全てのアプリケーションを強制的に終了します。開いているアプリケーションがデータを失う可能性があるため、緊急時のみ使用してください。</p>
    <p>「電源オフ」（8）はシステムをシャットダウンし、電源を切ります。</p>
  </dd>

</dl>

<h2 id="Remarks">備考</h2>
<p>システムをサンペンドまたはハイバネーションにするには、このページの末尾にある<a href="#ExSuspend">例2</a>をご覧ください。</p>
<p>モニターをオフにするには、<a href="SendMessage.htm#ExMonitorPower">SendMessage関数の例1</a>をご覧ください。</p>
<p>これに関連して、スクリプトは、システムがシャットダウンするときや、ユーザーが<a href="OnExit.htm">OnExit</a>を介してログオフするときを検出することができます。</p>
<h2 id="Related">関連</h2>
<p><a href="Run.htm">Run</a>、<a href="ExitApp.htm">ExitApp</a>、<a href="OnExit.htm">OnExit</a></p>
<h2 id="Examples">例</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> 警告せずに再起動します（再起動 + 警告せずに閉じる = 2 + 4 = 6）。</p>
<pre>Shutdown 6</pre>
</div>

<div class="ex" id="ExSuspend">
<p><a class="ex_number" href="#ExSuspend"></a> Windows API関数「SetSuspendState」を呼び出し、システムをサスペンドまたは休止状態にします。なお、2番目のパラメータは、新しいシステムではまったく効果がない場合があります。</p>
<pre><em>; Parameter #1: Pass 1 instead of 0 to hibernate rather than suspend.
; Parameter #2: Pass 1 instead of 0 to suspend immediately rather than asking each application for permission.
; Parameter #3: Pass 1 instead of 0 to disable all wake events.</em>
DllCall("PowrProf\SetSuspendState", "Int", 0, "Int", 0, "Int", 0)</pre>
</div>

</body>
</html>
