<!DOCTYPE HTML>
<html lang="ja">
<head>
<title>ListViewGetContent - Syntax &amp; Usage | AutoHotkey v2</title>
<meta name="description" content="The ListViewGetContent function returns a list of items/rows from a ListView." />
<meta name="ahk:equiv-v1" content="lib/ControlGet.htm#List" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>ListViewGetContent</h1>

<p>ListViewから項目/行のリストを返します。</p>

<pre class="Syntax">List := <span class="func">ListViewGetContent</span>(<span class="optional">Options, Control, WinTitle, WinText, ExcludeTitle, ExcludeText</span>)</pre>

<h2 id="Parameters">パラメータ</h2>
<dl>
    <dt>オプション</dt>
    <dd>
        <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
        <p>Specifices what to retrieve. If blank or omitted, all the text in the ListView is retrieved. Otherwise, specify zero or more of the following words, each separated from the next with a space or tab:</p>
        <p><strong>Selected:</strong> Returns only the selected (highlighted) rows rather than all rows. If none, the return value is blank.</p>
        <p><strong>Focused:</strong> Returns only the focused row. If none, the return value is blank.</p>
        <p id="ColN"><strong>Col4:</strong> Returns only the fourth column (field) rather than all columns (replace 4 with a number of your choice).</p>
        <p><strong>Count:</strong> Returns a single number that is the total number of rows in the ListView.</p>
        <p><strong>Count Selected:</strong> Returns the number of selected (highlighted) rows.</p>
        <p><strong>Count Focused:</strong> Returns the row number (position) of the focused row (0 if none).</p>
        <p><strong>Count Col:</strong> Returns the number of columns in the control (or -1 if the count cannot be determined).</p>
    </dd>
    <dt>Control</dt>
    <dd>
        <p>型：<a href="../Concepts.htm#strings">文字列</a>、<a href="../Concepts.htm#numbers">整数</a>、または<a href="../Objects.htm">オブジェクト</a></p>
        <p>コントロールのClassNN、text、HWND、または<code>Hwnd</code>プロパティを持つオブジェクトを指します。詳しくは、「<a href="Control.htm#Parameter">制御パラメータ</a>」をご覧ください。</p>
    </dd>
    <dt>WinTitle</dt>
    <dd>
        <p>型：<a href="../Concepts.htm#strings">文字列</a>、<a href="../Concepts.htm#numbers">整数</a>、または<a href="../Objects.htm">オブジェクト</a></p>
        <p>ウィンドウのタイトルなど、対象のウィンドウを特定する条件。<a href="../misc/WinTitle.htm">WinTitleを</a>参照してください。</p>
    </dd>
    <dt>WinText</dt>
    <dd>
        <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
        <p>存在する場合、このパラメータは、ターゲットウィンドウの単一のテキスト要素からの部分文字列でなければなりません（付属のWindow Spyユーティリティによって明らかにされます）。<a href="DetectHiddenText.htm">DetectHiddenText</a>がONの場合、隠しテキスト要素が検出されます。</p>
    </dd>
    <dt>ExcludeTitle</dt>
    <dd>
        <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
        <p>タイトルにこの値が含まれているWindowsは、審査対象外となります。</p>
    </dd>
    <dt>ExcludeText</dt>
    <dd>
        <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
        <p>テキストにこの値が含まれているウィンドウは、検討の対象外となります。</p>
    </dd>
</dl>

<h2 id="Return_Value">戻り値</h2>
<p>型：<a href="../Concepts.htm#strings">文字列</a></p>
<p>This function returns a list of items/rows. Within each row, each field (column) except the last will end with a tab character (`t). To access the items/rows individually, use a <a href="LoopParse.htm">parsing loop</a> as in <a href="#ExListView">example #1</a>.</p>

<h2 id="Error_Handling">エラー処理</h2>
<p>ウィンドウまたはコントロールが見つからない場合、<a href="Error.htm#TargetError">TargetError</a>が投げられる。</p>
<p>An <a href="Error.htm#OSError">OSError</a> is thrown if a message could not be sent to the control, or if the process owning the ListView could not be opened, perhaps due to a lack of user permissions or because it is locked.</p>
<p>A <a href="Error.htm#ValueError">ValueError</a> is thrown if the <a href="#ColN">Col<em>N</em> option</a> specifies a nonexistent column.</p>

<h2 id="Remarks">備考</h2>
<p>Some applications store their ListView text privately, which prevents their text from being retrieved. このような場合、通常、例外は発生しませんが、取得したフィールドはすべて空となります。</p>
<p>The columns in a ListView can be resized via <a href="SendMessage.htm">SendMessage</a> as shown in this example:</p>
<pre>SendMessage(0x101E, 0, 80, "SysListView321", WinTitle)  <em>; 0x101E is the message LVM_SETCOLUMNWIDTH.</em></pre>
<p>In the above, 0 indicates the first column (specify 1 for the second, 2 for the third, etc.) Also, 80 is the new width. Replace 80 with -1 to autosize the column. Replace it with -2 to do the same but also take into account the header text width.</p>
<p>ウィンドウのタイトルとテキストは大文字と小文字が区別されます。<a href="DetectHiddenWindows.htm">DetectHiddenWindows</a>がオンになっていない限り、隠しウィンドウは検出されません。</p>

<h2 id="Related">関連</h2>
<p><a href="ControlGetItems.htm">ControlGetItems</a>, <a href="WinGetList.htm">WinGetList</a>, <a href="Control.htm">Control functions</a></p>

<h2 id="Examples">例</h2>
<div class="ex" id="ExListView">
<p><a class="ex_number" href="#ExListView"></a> Extracts the individual rows and fields out of a ListView.</p>
<pre>List := ListViewGetContent("Selected", "SysListView321", WinTitle)
Loop Parse, List, "`n"  <em>; Rows are delimited by linefeeds (`n).</em>
{
    RowNumber := A_Index
    Loop Parse, A_LoopField, A_Tab  <em>; Fields (columns) in each row are delimited by tabs (A_Tab).</em>
        MsgBox "Row #" RowNumber " Col #" A_Index " is " A_LoopField
}</pre>
</div>

</body>
</html>
