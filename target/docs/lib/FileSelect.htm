<!DOCTYPE HTML>
<html lang="ja">
<head>
<title>FileSelect - 構文と使用法｜AutoHotkey v2</title>
<meta name="description" content="ファイル選択機能は、ファイルを開いたり保存したりするための標準的なダイアログを表示します。" />
<meta name="ahk:equiv-v1" content="lib/FileSelectFile.htm" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>FileSelect</h1>

<p>ファイルを開く、または保存するための標準的なダイアログを表示します。</p>

<pre class="Syntax">SelectedFile := <span class="func">FileSelect</span>(<span class="optional">Options, RootDir\Filename, Title, Filter</span>)</pre>
<h2 id="Parameters">パラメータ</h2>
<dl>

  <dt>オプション</dt>
  <dd>
      <p>型：<a href="../Concepts.htm#strings">文字列</a>または<a href="../Concepts.htm#numbers">整数</a></p>
      <p>省略した場合は、デフォルトで0となり、以下のオプションが何もないのと同じことになります。</p>
      <p>それ以外の場合は、数字または以下に示す文字のうちの1つで、オプションでその後に数字が続くこともある。例えば、<code>"M"</code>、"<code>1</code>、<code>"M1"</code>はすべて有効です（ただし、同等ではありません）。</p>
      <p id="D"><strong>D</strong>:フォルダー（ディレクトリ）を選択します。Dを指定すると、ファイルではなくフォルダーを選択できるようになります。このダイアログは、ファイルを選択するときとほぼ同じ機能を持ちますが、フィルターには対応していません（<em>フィルター</em>は省略または空白でなければなりません）。</p>
      <p id="M"><strong>M</strong>:マルチセレクトです。Shift-click、Control-clickなどで複数のファイルを選択できるようにする場合は、Mを指定します。この場合、戻り値は文字列ではなく、<a href="Array.htm">Array</a>になります。個々のファイルを取り出すには、このページ下部の例を参照してください。</p>
      <p id="S"><strong>S</strong>:保存ダイアログです。Sを指定すると、ダイアログに常に「開く」ボタンの代わりに「保存」ボタンが表示されるようになります。</p>
      <p>以下の番号を使用することができます。複数を効果的に使うには、それらを足し算します。例えば、1と2を使う場合は、数字の3を指定します。</p>
      <p><strong>1</strong>:ファイルが存在する必要がある<br>
        <strong>2</strong>:パスは存在しなければならない<br>
        <strong>8</strong>:新規ファイル作成時のプロンプト<br>
        <strong>16</strong>:ファイルを上書きするプロンプト<br>
        <strong>32</strong>:ショートカット（.lnkファイル）は、ターゲットに解決されるのではなく、そのまま選択されます。また、このオプションは、フォルダーショートカットによるフォルダーへのナビゲーションを防止します。</p>
      <p>上書き保存を促す」オプションは保存ダイアログでのみサポートされているため、「作成を促す」オプションを指定せずにこのオプションを指定すると、「S」オプションも有効になります。同様に、"S"オプションがある場合、"Prompt to Create"オプションは効果を発揮しません。24を指定すると、ダイアログでサポートされているどのタイプのプロンプトも有効になります。</p>
  </dd>

  <dt>RootDir\Filename</dt>
  <dd>
      <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
      <p>存在する場合、このパラメータには以下のいずれかまたは両方が含まれます：</p>
      <p><strong>RootDir</strong>:ルート（開始）ディレクトリ。絶対パスが指定されていない場合は、<a href="../Variables.htm#WorkingDir">A_WorkingDir</a>のサブフォルダとみなされます。省略または空白の場合、開始ディレクトリはOSのバージョンに依存するデフォルトとなります（おそらく、以前にFileSelectを使用した際に、ユーザーが最も最近選択したディレクトリとなるでしょう）。</p>
      <p><strong>Filename</strong>:ダイアログの編集フィールドに最初に表示されるデフォルトのファイル名です。裸のファイル名（パスなし）のみが表示されます。ダイアログが正しく表示されるように、不正な文字（/&lt;|: "など）が存在しないことを確認してください。</p>
      <p>例：</p>
      <pre>"C:\My Pictures\Default Image Name.gif"  <em>; <i>RootDir</i>と<i>Filename</i>の両方が存在します。</em>
"C:\My Pictures"  <em>; <i>RootDir</i>のみ存在します。</em>
"My Pictures"  <em>; <i>RootDir</i>のみが存在し、現在の作業ディレクトリからの相対パスです。</em>
"My File"  <em>; <i>Filename</i>のみ存在する（ただし、"My File"がフォルダとして存在する場合は、<i>RootDir</i>とする）。</em></pre>
  </dd>

  <dt>タイトル</dt>
  <dd>
      <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
      <p>ファイル選択ウィンドウのタイトルです。省略または空白の場合、デフォルトで<code>"ファイルを選択 - "<a href="../Variables.htm#ScriptName">A_ScriptName</a></code>（つまり、現在のスクリプトの名前）"となります。"D"オプションが存在する場合、"File"は "Folder"に置き換えられます。</p>
  </dd>

  <dt>Filter</dt>
  <dd>
      <p>型：<a href="../Concepts.htm#strings">文字列</a></p>
      <p>ダイアログで表示されるファイルの種類を示します。</p>
      <p>Example: Documents (*.txt)<br>
        Example: Audio (*.wav; *.mp2; *.mp3)</p>
      <p>省略された場合、フィルターのデフォルトは「すべてのファイル（*.*）」です。</p>
    <p>そうでない場合は、指定された文字列を使用しますが、ダイアログの「ファイルの種類」ドロップダウンリストに「すべてのファイル（*.*）」のオプションも用意されています。複数のファイル拡張子をフィルターに含めるには、上の例のようにセミコロンで区切ってください。</p>
    <p>"D"オプションがある場合、このパラメータは空白または省略する必要があります。</p>
  </dd>

</dl>

<h2 id="Return_Value">戻り値</h2>
<p>型：<a href="../Concepts.htm#strings">文字列</a>または<a href="../Concepts.htm#strings">文字列</a>の<a href="Array.htm">配列</a></p>
<p>マルチセレクトが有効でない場合、この関数は、ユーザーが選択した単一のファイルまたはフォルダのフルパスと名前を返し、ユーザーがダイアログをキャンセルした場合は空の文字列を返します。</p>
<p>Mオプション（複数選択）が有効な場合、この関数は項目の配列を返し、各項目は1つのファイルのフルパスと名前になります。本ページ下部の例では、ファイルを1つずつ抽出する方法を示しています。ユーザーがダイアログをキャンセルした場合、配列は空（アイテムがゼロ）になります。</p>

<h2 id="Remarks">備考</h2>
<p>ファイル選択ダイアログは、通常このように表示されます：</p>
<img src="../static/dlg_file.png" alt="FileSelect" />
<p>GUIウィンドウは、<a href="Gui.htm#OwnDialogs">+OwnDialogs</a>オプションにより、モーダルファイル選択ダイアログを表示することができる。モーダルダイアログは、ダイアログが解除されるまで、ユーザーがGUIウィンドウと対話するのを防ぎます。</p>
<p>既知の制限：ファイル選択ダイアログの表示中に起動する<a href="SetTimer.htm">タイマー</a>は、ダイアログ内でのクリックの効果をタイマー終了後まで延期します。これを回避するには、サブルーチンの終了に時間がかかるタイマーの使用を避けるか、ダイアログ中のタイマーをすべて無効にしてください：</p>
<pre><a href="Thread.htm">Thread</a> "NoTimers"
SelectedFile := FileSelect()
Thread "NoTimers", false</pre>

<h2 id="Related">関連</h2>
<p><a href="DirSelect.htm">DirSelect</a>, <a href="MsgBox.htm">MsgBox</a>, <a href="InputBox.htm">InputBox</a>, <a href="ToolTip.htm">ToolTip</a>, <a href="Gui.htm">GUI</a>, <a href="../misc/CLSID-List.htm">CLSID List</a>, <a href="LoopParse.htm">parsing loop</a>, <a href="SplitPath.htm">SplitPath</a></p>
<p>また、OSには、フォント、色、アイコンの選択を促すダイアログボックスが標準装備されています。これらのダイアログは、<a href="https://github.com/majkinetor/mm-autohotkey/tree/master/Dlg">GitHub</a>でデモされているように、<a href="DllCall.htm">DllCall</a>を介して表示することができます。</p>
<h2 id="Examples">例</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> 既存の.txtまたは.docファイルを選択できるようにします。</p>
<pre>SelectedFile := FileSelect(3, , "Open a file", "Text Documents (*.txt; *.doc)")
if SelectedFile = ""
    MsgBox "The dialog was canceled."
else
    MsgBox "The following file was selected:`n" SelectedFile</pre>
</div>

<div class="ex" id="ExMulti">
<p><a class="ex_number" href="#ExMulti"></a> 既存のファイルを複数選択できるようにします。</p>
<pre>SelectedFiles := FileSelect("M3")  <em>; M3 = 既存ファイルをマルチセレクトします。</em>
if SelectedFiles.Length = 0
{
    MsgBox "The dialog was canceled."
    return
}
for FileName in SelectedFiles
{
    Result := MsgBox("File #" A_Index " of " SelectedFiles.Length ":`n" FileName "`n`nContinue?",, "YN")
    if Result = "No"
        break
}
</pre>
</div>

<div class="ex" id="ExFolder">
<p><a class="ex_number" href="#ExFolder"></a> フォルダーを選択できるようにします。</p>
<pre>
SelectedFolder := FileSelect("D", , "Select a folder")
if SelectedFolder = ""
    MsgBox "The dialog was canceled."
else
    MsgBox "The following folder was selected:`n" SelectedFolder
</pre>
</div>

</body>
</html>
