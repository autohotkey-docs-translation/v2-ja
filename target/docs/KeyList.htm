<!DOCTYPE HTML>
<html lang="ja">
<head>
<title>キーリスト（キーボード、マウス、コントローラ）｜AutoHotkey v2</title>
<meta name="description" content="このページでは、ホットキーやキー固有の機能に使用できるすべてのマウスボタン、キーボードキー、コントローラボタンの一覧を表示します。" />
<meta name="keywords" content="keyboard,keys,key,mouse,buttons,button,controller,gamepad,joystick,create,hotkeys,hotkey,macros">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="static/theme.css" rel="stylesheet" type="text/css" />
<script src="static/content.js" type="text/javascript"></script>
</head>
<body>
<h1>キーリスト<span class="headnote">（キーボード、マウス、コントローラ）</span></h1>
<h2 id="toc">目次</h2>
<ul>
  <li><a href="#mouse">マウス</a>
    <ul>
      <li><a href="#mouse-general">一般的なボタン</a></li>
      <li><a href="#mouse-advanced">高度なボタン</a></li>
      <li><a href="#mouse-wheel">ホイール</a></li>
    </ul>
  </li>
  <li><a href="#keyboard">キーボード</a>
    <ul>
      <li><a href="#general">一般的なキー</a></li>
      <li><a href="#cursor">カーソル制御キー</a></li>
      <li><a href="#numpad">テンキー</a></li>
      <li><a href="#function">ファンクションキー</a></li>
      <li><a href="#modifier">修飾キー</a></li>
      <li><a href="#multimedia">マルチメディア キー</a></li>
      <li><a href="#other">その他のキー</a></li>
    </ul>
  </li>
  <li><a href="#Controller">ゲームコントローラー（ゲームパッド、ジョイスティックなど）</a></li>
  <li><a href="#remote">ハンドヘルドリモコン</a></li>
  <li><a href="#SpecialKeys">特殊キー</a></li>
  <li><a href="#IME">CapsLockとIME</a></li>
</ul>

<h2 id="mouse">マウス</h2>
<h3 id="mouse-general">一般的なボタン</h3>
<table class="info">
  <tr>
    <th style="width:12em">名前</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>LButton</td>
    <td>マウスの第1ボタン。どの物理ボタンに対応するかはシステムの設定によりますが、デフォルトでは左ボタンになっています。</td>
  </tr>
  <tr>
    <td>RButton</td>
    <td>マウスの第2ボタン。どの物理ボタンに対応するかはシステムの設定によりますが、デフォルトでは右ボタンになります。</td>
  </tr>
  <tr>
    <td>MButton</td>
    <td>中ボタンまたはホイールボタン</td>
  </tr>
</table>
<h3 id="mouse-advanced">高度なボタン</h3>
<table class="info">
  <tr>
    <th style="width:12em">名前</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>XButton1</td>
    <td>マウスの第4ボタン通常、Browser_Back と同じ機能を実行します。</td>
  </tr>
  <tr>
    <td>XButton2</td>
    <td>マウスの第5ボタン通常、Browser_Forward と同じ機能を実行します。</td>
  </tr>
</table>
<h3 id="mouse-wheel">ホイール</h3>
<table class="info">
  <tr>
    <th style="width:12em">名前</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>WheelDown</td>
    <td>ホイールを下（手前）に回します。</td>
  </tr>
  <tr>
    <td>WheelUp</td>
    <td>ホイールを上（自分から離れる方向）に回します。</td>
  </tr>
  <tr>
    <td>WheelLeft<br>WheelRight</td>
    <td><p>左右にスクロールします。</p>
    <p>2つめのホイールがあったり、ホイールを左右に傾けることができたりするマウスで<a href="Hotkeys.htm#HWheel">ホットキーとして使用</a>できます。場合によっては、マウスにバンドルされているソフトウェアを使用して、この機能を制御する必要があります。特定のマウスに関係なく、<a href="lib/Send.htm">Send</a> と <a href="lib/Click.htm">Click</a> を使用して、それをサポートするプログラムで水平方向にスクロールできます。</p></td>
  </tr>
</table>
<h2 id="keyboard">キーボード</h2>
<p class="note"><strong>注：</strong>文字と数字のキーの名前は、その1文字または数字と同じです。事例：b は <kbd>B</kbd> で、5 は <kbd>5</kbd>です。</p>
<p>任意の 1 文字をキー名として使用できますが、その意味（スキャン コードまたは仮想キーコード）は現在のキーボードレイアウトによって異なります。さらに、コンテキストによっては、一部の特殊文字をエスケープするか、中括弧で囲む必要があります。a-zまたはA-Zの文字は、現在のキーボードレイアウトに含まれていなくても、対応する仮想キーコード（通常はvk41～vk5A）を参照するために使用できます。</p>
<h3 id="general">一般的なキー</h3>
<table class="info">
  <tr>
    <th style="width:12em">名前</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>CapsLock</td>
    <td><kbd>CapsLock</kbd>（キャプスロックキー）
      <p class="warning"><strong>注：</strong>Windows IME は、CapsLock の検出と機能に干渉する場合があります。詳細については、<a href="#IME">CapsLockとIME</a> を参照してください。</p>
    </td>
  </tr>
  <tr>
    <td>Space</td>
    <td><kbd>Space</kbd>（スペースバー）</td>
  </tr>
  <tr>
    <td>Tab</td>
    <td><kbd>Tab</kbd>（タブキー）</td>
  </tr>
  <tr>
    <td>Enter</td>
    <td><kbd>Enter</kbd></td>
  </tr>
  <tr>
    <td>Escape（またはEsc）</td>
    <td><kbd>Esc</kbd></td>
  </tr>
  <tr>
    <td>Backspace（またはBS）</td>
    <td><kbd>Backspace</kbd></td>
  </tr>
</table>
<h3 id="cursor">カーソル制御キー</h3>
<table class="info">
  <tr>
    <th style="width:12em">名前</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>ScrollLock</td>
    <td><kbd>ScrollLock</kbd>（スクロールロックキー）<kbd>Ctrl</kbd>が押されている間、<kbd>ScrollLock</kbd> は <code>CtrlBreak</code>のキーコードを生成しますが、スキャンコードによって<kbd>Pause</kbd>と区別することができます。</td>
  </tr>
  <tr>
    <td>Delete（またはDel）</td>
    <td><kbd>Del</kbd></td>
  </tr>
  <tr>
    <td>Insert（またはIns）</td>
    <td><kbd>Ins</kbd></td>
  </tr>
  <tr>
    <td>Home</td>
    <td><kbd>Home</kbd></td>
  </tr>
  <tr>
    <td>End</td>
    <td><kbd>End</kbd></td>
  </tr>
  <tr>
    <td>PgUp</td>
    <td><kbd>PgUp</kbd>（ページアップキー）</td>
  </tr>
  <tr>
    <td>PgDn</td>
    <td><kbd>PgDn</kbd>（ページダウンキー）</td>
  </tr>
  <tr>
    <td>Up</td>
    <td><kbd>↑</kbd>（上矢印キー）</td>
  </tr>
  <tr>
    <td>Down</td>
    <td><kbd>↓</kbd>（下矢印キー）</td>
  </tr>
  <tr>
    <td>Left</td>
    <td><kbd>←</kbd>（左矢印キー）</td>
  </tr>
  <tr>
    <td>Right</td>
    <td><kbd>→</kbd>（右矢印キー）</td>
  </tr>
</table>
<h3 id="numpad">テンキー</h3>
<p>システムの動作上、スラッシュで区切られた以下のキーは、<kbd>NumLock</kbd>のON/OFFによって識別が異なります。<kbd>NumLock</kbd>がOFFの状態で<kbd>Shift</kbd>を押すと、一時的に<kbd>Shift</kbd>が解除され、<kbd>NumLock</kbd>がONであるかのように動作します。</p>
<table class="info">
  <tr>
    <th style="width:12em">名前</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>Numpad0 / NumpadIns</td><td><kbd>0</kbd> / <kbd>Ins</kbd></td>
  </tr>
  <tr>
    <td>Numpad1 / NumpadEnd</td><td><kbd>1</kbd> / <kbd>End</kbd></td>
  </tr>
  <tr>
    <td>Numpad2 / NumpadDown</td><td><kbd>2</kbd> / <kbd>↓</kbd></td>
  </tr>
  <tr>
    <td>Numpad3 / NumpadPgDn</td><td><kbd>3</kbd> / <kbd>PgDn</kbd></td>
  </tr>
  <tr>
    <td>Numpad4 / NumpadLeft</td><td><kbd>4</kbd> / <kbd>←</kbd></td>
  </tr>
  <tr>
    <td>Numpad5 / NumpadClear</td><td><kbd>5</kbd> / 通常は何もしません</td>
  </tr>
  <tr>
    <td>Numpad6 / NumpadRight</td><td><kbd>6</kbd> / <kbd>→</kbd></td>
  </tr>
  <tr>
    <td>Numpad7 / NumpadHome</td><td><kbd>7</kbd> / <kbd>Home</kbd></td>
  </tr>
  <tr>
    <td>Numpad8 / NumpadUp</td><td><kbd>8</kbd> / <kbd>↑</kbd></td>
  </tr>
  <tr>
    <td>Numpad9 / NumpadPgUp</td><td><kbd>9</kbd> / <kbd>PgUp</kbd></td>
  </tr>
  <tr>
    <td>NumpadDot / NumpadDel</td><td><kbd>.</kbd> / <kbd>Del</kbd></td>
  </tr>
  <tr>
    <td>NumLock</td>
    <td><kbd>NumLock</kbd>（ナンバーロックキー）。<kbd>Ctrl</kbd> が押されている間、<kbd>NumLock</kbd> は <code class="no-highlight">Pause</code>のキーコードを生成するため、ホットキーには<code>^NumLock</code>の代わりに<code class="no-highlight">^Pause</code>を使う。</td>
  </tr>
  <tr>
    <td>NumpadDiv</td>
    <td><kbd>/</kbd>（除算）</td>
  </tr>
  <tr>
    <td>NumpadMult</td>
    <td><kbd>*</kbd>（乗算）</td>
  </tr>
  <tr>
    <td>NumpadAdd</td>
    <td><kbd>+</kbd>（加算）</td>
  </tr>
  <tr>
    <td>NumpadSub</td>
    <td><kbd>-</kbd>（減算）</td>
  </tr>
  <tr>
    <td>NumpadEnter</td>
    <td><kbd>Enter</kbd></td>
  </tr>
</table>
<h3 id="function">ファンクションキー</h3>
<table class="info">
  <tr>
    <th style="width:12em">名前</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>F1～F24</td>
    <td>ほとんどのキーボードの上部にある12個以上のファンクションキーです。</td>
  </tr>
</table>
<h3 id="modifier">修飾キー</h3>
<table class="info">
  <tr>
    <th style="width:12em">名前</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>LWin</td>
    <td>左<kbd>Win</kbd>。<code>&lt;#</code> ホットキー プレフィックスに対応します。</td>
  </tr>
  <tr>
    <td>RWin</td>
    <td>
      <p>右<kbd>Win</kbd>。<code>&gt;#</code> ホットキー プレフィックスに対応します。</p>
      <p class="note"><strong>注：</strong><kbd>Ctrl</kbd>/<kbd>Alt</kbd>/<kbd>Shift</kbd>とは異なり、OSがサポートしていないため、汎用的、中立的な「Win」キーは存在しません。ただし、<code>#</code> 修飾子を含むホットキーは、<kbd>Win</kbd>のいずれかでトリガーできます。</p>
    </td>
  </tr>
  <tr>
    <td>Control（またはCtrl）</td>
    <td><kbd>Ctrl</kbd>。ホットキー（<code>Control::</code>）として、チルダ プレフィックスがない限り、リリース時に起動します。<code>^</code> ホットキー プレフィックスに対応します。</td>
  </tr>
  <tr>
    <td>Alt</td>
    <td><kbd>Alt</kbd>。ホットキー（<code>Alt::</code>）として、チルダ プレフィックスがない限り、リリース時に起動します。ホットキーのプレフィックス<code>!</code>に対応します。</td>
  </tr>
  <tr>
    <td>Shift</td>
    <td><kbd>Shift</kbd>。チルダのプレフィックスがない限り、ホットキー（<code>Shift::</code>）としてはリリース時に起動します。ホットキーのプレフィックス<code>+</code>に対応します。</td>
  </tr>
  <tr>
    <td>LControl（またはLCtrl）</td>
    <td>左<kbd>Ctrl</kbd>。ホットキーのプレフィックス<code>&lt;^</code>に対応します。</td>
  </tr>
  <tr>
    <td>RControl（またはRCtrl）</td>
    <td>右<kbd>Ctrl</kbd>。ホットキーのプレフィックス<code>&gt;^</code>に対応します。</td>
  </tr>
  <tr>
    <td>LShift</td>
    <td>左<kbd>Shift</kbd>。<code>&lt;+</code>ホットキーのプレフィックスに対応します。</td>
  </tr>
  <tr>
    <td>RShift</td>
    <td>右<kbd>Shift</kbd>。ホットキーの接頭辞<code>&gt;+</code>に対応します。</td>
  </tr>
  <tr>
    <td>LAlt</td>
    <td>左<kbd>Alt</kbd>。ホットキーのプレフィックス<code>&lt;!</code>に対応します。</td>
  </tr>
  <tr>
    <td>RAlt</td>
    <td>
      <p>右 <kbd>Alt</kbd>。ホットキーのプレフィックス<code>&gt;!</code>に対応します。</p>
      <p class="note"><strong>注：</strong>キーボードレイアウトにRAltの代わりにAltGrがある場合、<a href="Hotkeys.htm#AltGr">ここ</a>で説明されているように、<code>&lt;^&gt;!</code> を介してホットキーのプレフィックスとして使用することができます。それに加えて、<code>LControl &amp; RAlt::</code>は、AltGrをホットキーにします。</p>
    </td>
  </tr>
</table>
<h3 id="multimedia">マルチメディア キー</h3>
<p>以下の各キーに割り当てられている機能は、Windowsのレジストリを変更することで上書きすることができます。この表は、Windowsのほとんどのバージョンで、各キーのデフォルトの機能を示しています。</p>
<table class="info">
  <tr>
    <th style="width:12em">名前</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>Browser_Back</td>
    <td>戻る</td>
  </tr>
  <tr>
    <td>Browser_Forward</td>
    <td>進む</td>
  </tr>
  <tr>
    <td>Browser_Refresh</td>
    <td>更新</td>
  </tr>
  <tr>
    <td>Browser_Stop</td>
    <td>中止</td>
  </tr>
  <tr>
    <td>Browser_Search</td>
    <td>検索</td>
  </tr>
  <tr>
    <td>Browser_Favorites</td>
    <td>お気に入り</td>
  </tr>
  <tr>
    <td>Browser_Home</td>
    <td>ホームページ</td>
  </tr>
  <tr>
    <td>Volume_Mute</td>
    <td>ミュート</td>
  </tr>
  <tr>
    <td>Volume_Down</td>
    <td>音量を下げる</td>
  </tr>
  <tr>
    <td>Volume_Up</td>
    <td>音量を上げる</td>
  </tr>
  <tr>
    <td>Media_Next</td>
    <td>次のトラック</td>
  </tr>
  <tr>
    <td>Media_Prev</td>
    <td>前のトラック</td>
  </tr>
  <tr>
    <td>Media_Stop</td>
    <td>ストップ</td>
  </tr>
  <tr>
    <td>Media_Play_Pause</td>
    <td>再生/一時停止</td>
  </tr>
  <tr>
    <td>Launch_Mail</td>
    <td>デフォルトのメールソフトを起動します</td>
  </tr>
  <tr>
    <td>Launch_Media</td>
    <td>デフォルトのメディアプレーヤーを起動します</td>
  </tr>
  <tr>
    <td>Launch_App1</td>
    <td>PCを開きます。（以前のマイコンピュータまたはコンピュータ）</td>
  </tr>
  <tr>
    <td>Launch_App2</td>
    <td>電卓を起動します</td>
  </tr>
</table>
<h3 id="other">その他のキー</h3>
<table class="info">
  <tr>
    <th style="width:12em">名前</th>
    <th abbr="説明">説明</th>
  </tr>
  <tr>
    <td>AppsKey</td>
    <td><kbd>Menu</kbd>。右クリックのコンテキストメニューを呼び出すためのキーです。</td>
  </tr>
  <tr>
    <td>PrintScreen</td>
    <td><kbd>PrtSc</kbd>（プリントスクリーンキー）</td>
  </tr>
  <tr>
    <td>CtrlBreak</td>
    <td><kbd>Ctrl</kbd>+<kbd>Pause</kbd>または<kbd>Ctrl</kbd>+<kbd>ScrollLock</kbd></td>
  </tr>
  <tr>
    <td>Pause</td>
    <td><kbd>Pause</kbd>または<kbd>Ctrl</kbd>+<kbd>NumLock</kbd>。<kbd>Ctrl</kbd>を押している間は、<kbd>Pause</kbd>は <code>CtrlBreak</code>、<kbd>NumLock</kbd>は <code class="no-highlight">Pause</code>のキーコードを生成するので、ホットキーでは<code class="no-highlight">^Pause</code>の代わりに<code>^CtrlBreak</code>を使用します。</td>
  </tr>
  <tr>
    <td>Help</td>
    <td><kbd>Help</kbd>。これはおそらく、ほとんどのキーボードに存在しないと思われます。通常<kbd>F1</kbd>とは異なります。</td>
  </tr>
  <tr>
    <td>Sleep</td>
    <td><kbd>Sleep</kbd>。なお、キーボードによってはスリープキーが効かないことがあります。</td>
  </tr>
  <tr id="sc">
    <td>SC<b>nnn</b></td>
    <td>キーのスキャンコードを<b>nnn</b>に指定します。上記以外の珍しいキーも認識します。詳しくは<a href="#SpecialKeys">特殊キー</a>をご覧ください。</td>
  </tr>
  <tr id="vk">
    <td >VK<b>nn</b></td>
    <td><p><b>nn</b>には、キーの16進数の仮想キーコードを指定します。このめったに使われない方法は、ある種の<a href="Hotkeys.htm">ホットキー</a>が <a href="lib/InstallKeybdHook.htm">キーボードフック</a>を必要としないようにもします。例えば、以下のホットキーはキーボードフックを使用しませんが、副作用として、<kbd>Home</kbd>またはNumpadHomeの<em>いずれか</em>を押すと起動します：</p>
      <pre>^VK24::MsgBox "You pressed Home or NumpadHome while holding down Control."
</pre>
      <p><strong>既知の制限事項：</strong><code>*VK24</code>や <code>~VK24</code>など、<a href="lib/InstallKeybdHook.htm">キーボードフック</a>を強制的に使用するVKホットキーは、両方のキーではなく、どちらか一方のキーに対して起動します（例：NumpadHomeは<kbd>Home</kbd>ではありません）。VKnn方式の詳細については、<a href="#SpecialKeys">特殊キー</a>を参照してください。</p>
      <p class="warning"><strong>警告：</strong>VKnnとSCnnnの組み合わせに対応しているのは、<a href="lib/Send.htm">Send</a>関数、<a href="lib/GetKeyName.htm">GetKeyName</a>関数、<a href="lib/GetKeyVK.htm">GetKeyVK</a>関数、<a href="lib/GetKeySC.htm">GetKeySC</a>関数、<a href="lib/A_MenuMaskKey.htm">A_MenuMaskKey</a>のみです。それ以外のとき、または他の無効な接尾辞があるときは、キーは認識されません。例えば、<code>vk1Bsc001::</code>はエラーになります。</p>
      </td>
  </tr>
</table>
<h2 id="Controller">ゲームコントローラー（ゲームパッド、ジョイスティックなど）</h2>
<p class="note"><strong>注：</strong>歴史的な理由から、以下のボタンとコントロールの名前はジョイスティックを意味する<code>Joy</code>で始まります。しかし、通常はゲームパッドやステアリングホイールなど、他のゲームコントローラーにも使用できます。</p>
<p><strong>Joy1からJoy32：</strong>コントローラーのボタン。コントローラのボタン番号を決定するには、以下の<a href="scripts/index.htm#ControllerTest">テストスクリプト</a>を使用します。なお、^（control）、+（shift）などの<a href="Hotkeys.htm">ホットキー接頭記号</a>はサポートしていません（<a href="lib/GetKeyState.htm">GetKeyState</a>で代替できます）。また、コントローラボタンの押下を検出するように設計されているウィンドウでは、コントローラボタンの押下は常にアクティブウィンドウを「通過」することに注意してください。</p>
<p>以下のコントロール名はホットキーとして使用できませんが、<a href="lib/GetKeyState.htm">GetKeyState</a>で使用できます：</p>
<ul>
  <li><strong>JoyX、JoyY、JoyZ：</strong>ジョイスティックのX軸（水平）、Y軸（垂直）、Z軸（高度/深さ）。</li>
  <li><strong>JoyR：</strong>ジョイスティックのラダーまたは第4軸。</li>
  <li><strong>JoyU and JoyV：</strong>ジョイスティックの第5軸と第6軸。</li>
  <li><strong>JoyPOV：</strong>視点（ハット）コントロール。</li>
  <li><strong>JoyName：</strong>コントローラまたはそのドライバの名前。</li>
  <li><strong>JoyButtons：</strong>コントローラがサポートするボタンの数（必ずしも正確ではありません）。</li>
  <li><strong>JoyAxes：</strong>コントローラがサポートする軸の数。</li>
  <li><strong>JoyInfo：</strong>コントローラの能力を示す、以下の文字からなる文字列を提供します：<strong>Z</strong>（Z軸を持つ）、<strong>R</strong>（R軸を持つ）、<strong>U</strong>（U軸を持つ）、<strong>V</strong>（V軸を持つ）、<strong>P</strong>（POVコントロールを持つ）、<strong>D</strong>（POVコントロールは離散的／明確な設定が限られている）、<strong>C</strong>（POVコントロールは連続／微細である）。文字列の例：ZRUVPD</li>
</ul>
<p>例えば、Xbox Wireless/360コントローラーを使用する場合、JoyX/JoyYは左スティック、JoyR/JoyUは右スティック、JoyZは左右のトリガー、JoyPOVは方向パッド（Dパッド）となります。</p>
<p><strong>複数のコントローラー：</strong>コンピュータに複数のコントローラがあり、最初のコントローラ以外のコントローラを使用する場合は、コントロール名の前にコントローラ番号（最大16）を含めます。例えば、2joy1は2つ目のコントローラーの最初のボタン。</p>
<p class="note"><strong>注：</strong>スクリプトがコントローラを認識できない場合は、コントローラが1つしかなくても、コントローラ番号を1以外に指定してください。このような状況がどのように発生するのか、または正常かどうかは不明ですが、<a href="scripts/index.htm#ControllerTest">コントローラのテストスクリプト</a>でコントローラ番号を実験することで、システムに該当するかどうかを判断することができます。</p>
<p><strong>こちらも参照のこと：</strong></p>
<ul>
  <li><a href="misc/RemapController.htm">コントローラーのリマッピング</a>：コントローラでキーストロークやマウスクリックを送信する方法。</li>
  <li><a href="scripts/index.htm#ControllerMouse">Controller-To-Mouseのスクリプト</a>：コントローラーをマウスとして使う。</li>
</ul>

<h2 id="remote">ハンドヘルドリモコン</h2>
<p><a href="scripts/index.htm#WinLIRC">WinLIRCクライアントスクリプト</a>により、手持ちのリモコンからの信号に応答します。</p>
<h2 id="SpecialKeys">特殊キー</h2>
<p>キーボードやマウスに上記以外のキーがある場合でも、以下の手順でホットキーにすることができる場合があります：</p>
<ol>
  <li><a href="lib/InstallKeybdHook.htm">キーボードフック</a>を使用するスクリプトが少なくとも1つ実行されていることを確認します。スクリプトにキーボードフックがあるかどうかは、スクリプトの<a href="Program.htm#main-window">メインウィンドウ</a>を開き、メニューバーから「表示-&gt;<a href="lib/KeyHistory.htm">キー履歴</a>」を選択することで確認できます。</li>
  <li>そのスクリプトの<a href="Program.htm#tray-icon">トレイアイコン</a>をダブルクリックして、<a href="Program.htm#main-window">メインウィンドウ</a>を開きます。</li>
  <li>キーボードの「何れかのキー」を押します。</li>
  <li>メニューの「View-&gt;<a href="lib/KeyHistory.htm">Key history</a>」を選択します</li>
  <li>ページ下部までスクロールしてください。下の方に、キーのキーダウンイベントとキーアップイベントがあります。注：一部のキーはイベントが発生しないため、ここでは表示されません。この場合、キーボードドライバーやハードウェアが、AutoHotkeyがアクセスするには低すぎるレベルで扱うため、その特定のキーを直接ホットキーとすることはできません。解決策については、さらに以下をご覧ください。</li>
  <li>キーが検出可能な場合は、リストの2列目にある3桁の16進数値をメモしてください（例：<strong>159</strong>）。</li>
  <li>このキーをホットキーとして定義するには、次の例に従います：
<pre>
<strong>SC159::</strong>MsgBox ThisHotkey " was pressed." <em>; 159をキーの値で置き換えます。</em>
</pre><a href="Hotkeys.htm#ThisHotkey">ThisHotkey</a>もご覧ください。</li>
</ol>
<p><strong>逆方向：</strong>他のキーを「ミステリー・キー」<em>に</em>リマップするには、次のようにします：</p>
<pre><em>; 159を上記で発見された値で置き換えてください。必要であればFFを
; キーヒストリー画面の最初の列にある仮想キーで置き換えます。</em>
#c::Send "{vkFFsc159}" <em>; 詳しくは <a href="lib/Send.htm#vk">Send {vkXXscYYY}</a> をご覧ください。</em></pre>
<p><strong>別の解決策：</strong>キーまたはマウスボタンが「<a href="lib/KeyHistory.htm">キー履歴</a>」画面で検出できない場合は、次のいずれかをお試しください：</p>
<ol>
  <li>
    <p>マウスやキーボードに付属のソフトウェア（コントロールパネルやスタートメニューからアクセスできる場合もあります）を再設定して、「いずれかのキー」が他のキーストロークを送信するようにします。このようなキーストロークは、スクリプトのホットキーとして定義することができます。例えば、<kbd>Ctrl</kbd>+<kbd>F1</kbd>を送信するようにミステリーキーを設定した場合、スクリプトで<code>^F1::</code>を使うことで、間接的にそのキーをホットキーとして使用することができます。</p>
  </li>
  <li>
    <p>フォーラムのアーカイブを検索して<a href="https://www.autohotkey.com/board/topic/38015-ahkhid-an-ahk-implementation-of-the-hid-functions/">AHKHID</a>を試してみてください。また、<code>RawInput*</code>、<code>USB HID</code>または<code>AHKHID</code>などのキーワードで<a href="https://www.autohotkey.com/boards/">フォーラム</a>を検索してみるのもよいでしょう。</p>
  </li>
  <li>
    <p>以下は最終手段であり、一般的には絶望的な場合にのみ試みるべきものです。成功する確率が低く、元に戻すのが困難な望まない副作用を引き起こす可能性があるからです：<br>
      キーボードやマウスに付属している余分なソフトウェアを無効化または削除するか、OSに内蔵されているような標準的なドライバーに変更してください。これは、お使いのキーボードやマウスにそのようなドライバがあり、そのカスタムドライバやソフトウェアが提供する機能なしでいられることを前提としています。</p>
  </li>
</ol>

<h2 id="IME">CapsLockとIME</h2>
<p>Windows IMEの一部の構成（英語キーボードで日本語入力など）では、CapsLockを使用してモードを切り替えます。このような場合、CapsLockはIMEによって抑制されてAutoHotkeyで検出することができません。ただし、<kbd>Alt</kbd>+<kbd>CapsLock</kbd>、 <kbd>Ctrl</kbd>+<kbd>CapsLock</kbd>および<kbd>Shift</kbd>+<kbd>CapsLock</kbd>のショートカットは、回避策で無効にすることができます。具体的には、キーアップを送信してIMEの状態を変更するが、キーボードフックに信号を送ってイベントを抑制することで、他の影響を防ぐことができます。その際、以下の機能を利用することができます：</p>
<pre filename="SendSuppressedKeyUp.ahk">
<em>; キーボードフックのインストールが必要です。</em>
InstallKeybdHook
SendSuppressedKeyUp(key) {
    DllCall("keybd_event"
        , "char", GetKeyVK(key)
        , "char", GetKeySC(key)
        , "uint", KEYEVENTF_KEYUP := 0x2
        , "uptr", KEY_BLOCK_THIS := 0xFFC3D450)
}
</pre>
<p>この関数をスクリプトにコピーするか、<a href="Scripts.htm#lib">Libフォルダ</a>に<em>SendSuppressedKeyUp.ahk</em>として保存し、スクリプトに<code>#Include &lt;SendSuppressedKeyUp&gt;</code>を追加すると、次のように使えるようになります：</p>
<pre>
<em>; IME の Alt+key ショートカットを無効にします。</em>
~LAlt::SendSuppressedKeyUp "LAlt"

<em>; ホットキーのテスト：</em>
!CapsLock::MsgBox A_ThisHotkey

<em>; IMEと互換性のある方法で、CapsLockをLCtrlにリマップします。</em>
*CapsLock::
{
    Send "{Blind}{LCtrl DownR}"
    SendSuppressedKeyUp "LCtrl"
}
*CapsLock up::
{
    Send "{Blind}{LCtrl Up}"
}
</pre>

</body>
</html>
